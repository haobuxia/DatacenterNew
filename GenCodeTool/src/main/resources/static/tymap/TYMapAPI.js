/**
 * Created by TYKJ on 2016/8/20.
 version v1.1
 */document.write("\x3cscript type\x3d'text/javascript' src\x3d'http://webapi.amap.com/maps?v\x3d1.3\x26key\x3d89971aadd0917c08c7ece8b91df305da\x26plugin\x3dAMap.Driving,AMap.DistrictSearch,AMap.CustomLayer,AMap.Geocoder,AMap.Scale,AMap.OverView,AMap.ToolBar,AMap.Heatmap'\x3e\x3c/script\x3e");document.write(" \x3cstyle\x3e .csssprite {display: none;}\x3c/style\x3e");var _ty_tileType=0,_ty_overlays=[],TYEnumSpAsis={P_PGON:1,LINE_SIS:2,PLOYGON_SIS:3},TYEnumTraffic={TY_TRAFFIC_360:1,TY_TRAFFIC_QQ:2,TY_TRAFFIC_AMAP:3},TYEnumLngLatType={TY_GPS:1,TY_GCJ:2,TY_BD:3},TYEnumMapType={TY_GD_VEC:2,TY_GD_IMG:3,TY_QQ_VEC:4,TY_QQ_IMG:5,TY_QQ_Land:6,TY_360_VEC:7,TY_360_IMG:8,TY_Google_VEC:9,TY_Google_IMG:10,TY_Google_Land:11,TY_TDT_VEC:12,TY_TDT_IMG:13,TY_VEC:14};function TYEventOptions(a){a&&(a.event&&(this.event=a.event),a.callback&&(this.callback=a.callback))}var TYEnumEvent={TY_RIGHTCLICK:"rightclick",TY_CLICK:"click",TY_DOUBLECLICK:"dblclick",TY_MOUSEOVER:"mouseover",TY_DRAGSTART:"dragstart",TY_DRAGEND:"dragend",TY_ZOOMCHANGE:"zoomchange",TY_DRAGGING:"dragging"},TYEnumOverLay={TY_POINT:1,TY_POLYLINE:2,TY_CIRCLE:3,TY_POLYGON:4,TY_RECTANGLE:5},TYEnumGeocoder={TY_EXACT_DESC:1,TY_NEAR_DESC:2,TY_Road_DESC:3},TYEnumMassShape={TY_MASS_CUSTOM:1,TY_MASS_CIRCLE:2,TY_MASS_STAR:3,TY_MASS_BULLE:4,TY_MASS_RECT:5},TYEnumMassSize={TY_MASS_SUPERBIG:4,TY_MASS_BIG:3,TY_MASS_MIDDLE:2,TY_MASS_SMALL:1},TYEnumDrivingPolicy={LEAST_TIME:1,LEAST_MONEY:2,LEAST_DISTANCE:3,REAL_TRAFFIC:4};function TYMarker(a){this.icon=this.lnglat=this.label=this.pointId=null;this.offset=new TYPixel(-10,-34);a&&(a.pointId&&(this.pointId=a.pointId),a.label&&(this.label=a.label),a.lnglat&&(this.lnglat=a.lnglat),a.icon&&(this.icon=a.icon),a.offset&&(this.offset=a.offset))}function TYLine(a){this.lineId=this.lnglat=null;this.lineColor="blue";this.lineWidth=1;this.lineType="solid";this.lineOpacity=.6;this.isEdit=!1;a&&(a.lnglat&&(this.lnglat=a.lnglat),a.pointId&&(this.pointId=a.pointId),a.lineColor&&(this.lineColor=a.lineColor),a.lineWidth&&(this.lineWidth=a.lineWidth),a.lineType&&(this.lineType=a.lineType),a.lineOpacity&&(this.lineOpacity=a.lineOpacity),void 0!=a.isEdit&&(this.isEdit=a.isEdit))}function TYRectangle(a){this.b_l_LngLat=this.t_r_LngLat=this.rectangleId=null;this.lineColor="blue";this.lineWidth=1;this.lineType="solid";this.lineOpacity=.6;this.fillColor="white";this.fillOpacity=.6;this.isEdit=!1;a&&(a.rectangleId&&(this.rectangleId=a.rectangleId),a.t_r_LngLat&&(this.t_r_LngLat=a.t_r_LngLat),a.b_l_LngLat&&(this.b_l_LngLat=a.b_l_LngLat),a.lineColor&&(this.lineColor=a.lineColor),a.lineWidth&&(this.lineWidth=a.lineWidth),a.lineType&&(this.lineType=a.lineType),a.lineOpacity&&(this.lineOpacity=a.lineOpacity),a.fillColor&&(this.fillColor=a.fillColor),a.fillOpacity&&(this.fillOpacity=a.fillOpacity),a.isEdit&&(this.isEdit=a.isEdit))}function TYPolygon(a){this.polygonId=this.lnglat=null;this.lineColor="blue";this.lineWidth=1;this.lineType="solid";this.lineOpacity=.6;this.fillColor="white";this.fillOpacity=.6;this.isEdit=!1;a&&(a.lnglat&&(this.lnglat=a.lnglat),a.polygonId&&(this.polygonId=a.polygonId),a.lineColor&&(this.lineColor=a.lineColor),a.lineWidth&&(this.lineWidth=a.lineWidth),a.lineType&&(this.lineType=a.lineType),a.lineOpacity&&(this.lineOpacity=a.lineOpacity),a.fillColor&&(this.fillColor=a.fillColor),a.fillOpacity&&(this.fillOpacity=a.fillOpacity),void 0!=a.isEdit&&(this.isEdit=a.isEdit))}function TYCircle(a){this.radius=this.circleId=this.lnglat=null;this.lineColor="blue";this.lineWidth=1;this.lineType="solid";this.lineOpacity=.6;this.fillColor="white";this.fillOpacity=.6;this.isEdit=!1;a&&(a.lnglat&&(this.lnglat=a.lnglat),a.circleId&&(this.circleId=a.circleId),a.radius&&(this.radius=a.radius),a.lineColor&&(this.lineColor=a.lineColor),a.lineWidth&&(this.lineWidth=a.lineWidth),a.lineType&&(this.lineType=a.lineType),a.lineOpacity&&(this.lineOpacity=a.lineOpacity),a.fillColor&&(this.fillColor=a.fillColor),a.fillOpacity&&(this.fillOpacity=a.fillOpacity),void 0!=a.isEdit&&(this.isEdit=a.isEdit))}function TYMapOptions(a){this.lnglat=this.contentId=null;this.mapLevel=12;a&&(a.contentId&&(this.contentId=a.contentId),a.lnglat&&(this.lnglat=a.lnglat),a.mapLevel&&(this.mapLevel=a.mapLevel))}function TYConfigOption(a){this.isScrollWheel=this.isJog=this.isKeyboard=this.isDoubleClickZoom=this.isZoom=this.isDrag=this.isRotate=this.isAnimate=this.isShowSale=this.isShowControl=this.isShowOverView=!0;a&&(void 0!=a.isShowOverView&&(this.isShowOverView=a.isShowOverView),void 0!=a.isShowControl&&(this.isShowControl=a.isShowControl),void 0!=a.isShowSale&&(this.isShowSale=a.isShowSale),void 0!=a.isAnimate&&(this.isAnimate=a.isAnimate),void 0!=a.isRotate&&(this.isRotate=a.isRotate),void 0!=a.isDrag&&(this.isDrag=a.isDrag),void 0!=a.isZoom&&(this.isZoom=a.isZoom),void 0!=a.isDoubleClickZoom&&(this.isDoubleClickZoom=a.isDoubleClickZoom),void 0!=a.isKeyboard&&(this.isKeyboard=a.isKeyboard),void 0!=a.isJog&&(this.isJog=a.isJog),void 0!=a.isScrollWheel&&(this.isScrollWheel=a.isScrollWheel))}function TYBoundsOption(a){this.b_l_lnglat=this.t_r_lnglat=null;a&&(a.t_r_lnglat&&(this.t_r_lnglat=a.t_r_lnglat),a.b_l_lnglat&&(this.b_l_lnglat=a.b_l_lnglat))}function TYPointOption(a){this.pointData=[];this.pointState={isSetView:!0,isClearOverlay:!0,isGather:!1,overlayEvent:null};a&&(a.pointData&&(this.pointData=a.pointData),a.pointState&&(void 0!=a.pointState.isSetView&&(this.pointState.isSetView=a.pointState.isSetView),void 0!=a.pointState.isClearOverlay&&(this.pointState.isClearOverlay=a.pointState.isClearOverlay),void 0!=a.pointState.isGather&&(this.pointState.isGather=a.pointState.isGather),a.pointState.overlayEvent&&(this.pointState.overlayEvent=a.pointState.overlayEvent)))}function TYLineOption(a){this.lineData=[];this.lineState={isSetView:!0,isClearOverlay:!0,overlayEvent:null};a&&(a.lineData&&(this.lineData=a.lineData),a.lineState&&(void 0!=a.lineState.isSetView&&(this.lineState.isSetView=a.lineState.isSetView),void 0!=a.lineState.isClearOverlay&&(this.lineState.isClearOverlay=a.lineState.isClearOverlay),a.lineState.overlayEvent&&(this.lineState.overlayEvent=a.lineState.overlayEvent)))}function TYRectangleOption(a){this.rectangleData=[];this.rectangleState={isSetView:!0,isClearOverlay:!0,overlayEvent:null};a&&(a.rectangleData&&(this.rectangleData=a.rectangleData),a.rectangleState&&(void 0!=a.rectangleState.isSetView&&(this.rectangleState.isSetView=a.rectangleState.isSetView),void 0!=a.rectangleState.isClearOverlay&&(this.rectangleState.isClearOverlay=a.rectangleState.isClearOverlay),a.rectangleState.overlayEvent&&(this.rectangleState.overlayEvent=a.rectangleState.overlayEvent)))}function TYPolygonOption(a){this.polygonData=[];this.polygonState={isSetView:!0,isClearOverlay:!0,overlayEvent:null};a&&(a.polygonData&&(this.polygonData=rectangleOption.polygonData),a.polygonState&&(void 0!=a.polygonState.isSetView&&(this.polygonState.isSetView=a.polygonState.isSetView),void 0!=a.polygonState.isClearOverlay&&(this.polygonState.isClearOverlay=a.polygonState.isClearOverlay),a.polygonState.overlayEvent&&(this.polygonState.overlayEvent=a.polygonState.overlayEvent)))}function TYCircleOption(a){this.circleData=[];this.circleState={isSetView:!0,isClearOverlay:!0,overlayEvent:null};a&&(a.circleData&&(this.circleData=a.circleData),a.circleState&&(void 0!=a.circleState.isSetView&&(this.circleState.isSetView=a.circleState.isSetView),void 0!=a.circleState.isClearOverlay&&(this.circleState.isClearOverlay=a.circleState.isClearOverlay),a.circleState.overlayEvent&&(this.circleState.overlayEvent=a.circleState.overlayEvent)))}function TYOverlayOption(a){this.overlayType=null;this.isShowMath=!1;this.callfunc=null;this.isClearOverlay=!1;a&&(a.overlayType&&(this.overlayType=a.overlayType),void 0!=a.isShowMath&&(this.isShowMath=a.isShowMath),a.callfunc&&(this.callfunc=a.callfunc),void 0!=a.isClearOverlay&&(this.isClearOverlay=a.isClearOverlay))}function TYInfoWindowOptions(a){this.width=300;this.height=200;this.offset=new TYPixel(0,0);this.position=this.content=null;this.enableCloseOnClick=this.isCustom=this.showShadow=!1;a&&(a.width&&(this.width=a.width),a.height&&(this.height=a.height),a.offset&&(this.offset=a.offset),a.content&&(this.content=a.content),a.position&&(this.position=a.position),void 0!=a.showShadow&&(this.showShadow=a.showShadow),void 0!=a.isCustom&&(this.isCustom=a.isCustom),void 0!=a.enableCloseOnClick&&(this.enableCloseOnClick=a.enableCloseOnClick))}function TYSpasisOptions(a){this.polyGon=this.polyLine=this.point=this.sisType=null;a&&(a.sisType&&(this.sisType=a.sisType),a.point&&(this.point=a.point),a.polyLine&&(this.polyLine=a.polyLine),a.polyGon&&(this.polyGon=a.polyGon))}function TYGetLocationOptions(a){this.callback=this.address=null;a&&(a.address&&(this.address=a.address),a.callback&&(this.callback=a.callback))}function TYGeoCoderOptions(a){this.batch=!1;this.callback=this.type=this.location=null;a&&(void 0!=a.batch&&(this.batch=a.batch),a.location&&(this.location=a.location),a.type&&(this.type=a.type),a.callback&&(this.callback=a.callback))}function TYTilesOptions(a){this.TYMapType=TYEnumMapType.TY_GD_VEC;a&&(this.TYMapType=a)}function TYLocusOption(a){this.locusData={locusId:null,label:null,icon:"http://wd.tygps.com:82/tymap/carright.png",lnglat:[],lineType:"solid",lineWidth:3,nodeIcon:null,lineOpacity:.6,lineColor:"#0000ff"};this.locusState={moveSpeed:100,carIcon:null,isSetView:!0,syncEvent:null,circlable:!1,overlayEvent:null};a&&a.locusData&&(a.locusData.locusId&&(this.locusData.locusId=a.locusData.locusId),a.locusData.icon&&(this.locusData.icon=a.locusData.icon),a.locusData.label&&(this.locusData.label=a.locusData.label),a.locusData.lnglat&&(this.locusData.lnglat=a.locusData.lnglat),a.locusData.lineType&&(this.locusData.lineType=a.locusData.lineType),a.locusData.nodeIcon&&(this.locusData.nodeIcon=a.locusData.nodeIcon),a.locusData.lineWidth&&(this.locusData.lineWidth=a.locusData.lineWidth),a.locusData.lineColor&&(this.locusData.lineColor=a.locusData.lineColor),a.locusState&&(a.locusState.moveSpeed&&(this.locusState.moveSpeed=a.locusState.moveSpeed),a.locusState.carIcon&&(this.locusState.carIcon=a.locusState.carIcon),void 0!=a.locusState.isSetView&&(this.locusState.isSetView=a.locusState.isSetView),a.locusState.syncEvent&&(this.locusState.syncEvent=a.locusState.syncEvent),void 0!=a.locusState.circlable&&(this.locusState.circlable=a.locusState.circlable),a.locusState.overlayEvent&&(this.locusState.overlayEvent=a.locusState.overlayEvent)))}function renderData(a){this.icon=this.label=this.lnglat=this.renderId=null;this.borderColor="0000ff";this.borderWidth=2;this.fillColor="ffffff";a&&(a.renderId&&(this.renderId=a.renderId),a.icon&&(this.icon=a.icon),a.lnglat&&(this.lnglat=a.lnglat),a.borderWidth&&(this.borderWidth=a.borderWidth),a.label&&(this.label=a.label),a.borderColor&&(this.borderColor=a.borderColor.trim("#")),a.fillColor&&(this.fillColor=a.fillColor.trim("#")))}function TYAreaRenderOption(a){this.renderDatas=[];a&&a.renderDatas&&(this.renderDatas=a.renderDatas);this.renderState={tileOpacity:.4,isClearOverlay:!0,isSetView:!0,overlayEvent:null};a&&a.renderState&&(this.renderState.tileOpacity&&(this.renderState.tileOpacity=a.renderState.tileOpacity),void 0!=this.renderState.isClearOverlay&&(this.renderState.isClearOverlay=a.renderState.isClearOverlay),void 0!=this.renderState.isSetView&&(this.renderState.isSetView=a.renderState.isSetView),this.renderState.overlayEvent&&(this.renderState.overlayEvent=a.renderState.overlayEvent))}function MassPoint(a){this.lat=this.lng=this.id=null;this.color="#00ff00";this.type=TYEnumMassShape.TY_MASS_STAR;this.size=TYEnumMassSize.TY_MASS_MIDDLE;this.url="http://webapi.amap.com/theme/v1.3/markers/n/mark_b.png";this.opacity=1;a&&(a.id&&(this.id=a.id),a.lng&&(this.lng=a.lng),a.lat&&(this.lat=a.lat),a.color&&(this.color=a.color),a.type&&(this.type=a.type),a.size&&(this.size=a.size),a.url&&(this.url=a.url),a.opacity&&(this.opacity=a.opacity))}function TYMassPointOption(a){this.massPointDatas=[];this.massPointState={isClearOverlay:!0,isSetView:!0,overlayEvent:null};a&&(a.massPointDatas&&(this.massPointDatas=a.massPointDatas),a.massPointState&&(void 0!=a.massPointState.isClearOverlay&&(this.massPointState.isClearOverlay=a.massPointState.isClearOverlay),void 0!=a.massPointState.isSetView&&(this.massPointState.isSetView=a.massPointState.isSetView),a.massPointState.overlayEvent&&(this.massPointState.overlayEvent=a.massPointState.overlayEvent)))}function TYHeatMapOption(a){this.heatMapData={radius:30,gradient:{"0.4":"rgb(0, 255, 255)","0.65":"rgb(0, 110, 255)","0.85":"rgb(100, 0, 255)",1:"rgb(100, 0, 255)"},opacity:[0,1],zooms:[3,18],max:null,DataSet:{}};this.heatMapState={isClearOverlay:!0};a&&(a.heatMapData&&(a.heatMapData.radius&&(this.heatMapData.radius=a.heatMapData.radius),a.heatMapData.gradient&&(this.heatMapData.gradient=a.heatMapData.gradient),a.heatMapData.opacity&&(this.heatMapData.opacity=a.heatMapData.opacity),a.heatMapData.zooms&&(this.heatMapData.zooms=a.heatMapData.zooms),a.heatMapData.max&&(this.heatMapData.max=a.heatMapData.max),a.heatMapData.DataSet&&(this.heatMapData.DataSet=a.heatMapData.DataSet)),a.heatMapState&&void 0!=a.heatMapState.isClearOverlay&&(this.heatMapState.isClearOverlay=a.heatMapState.isClearOverlay))}function TYPanoramaOption(a){this.containerId;this.position;a&&(a.containerId&&(this.containerId=a.containerId),a.position&&(this.position=a.position))}function TYDrivingOptions(a){this.policy=TYEnumDrivingPolicy.LEAST_TIME;this.passWayPoints=[];this.callback=this.panelId=this.destination=this.origin=null;a&&(a.policy&&(this.policy=a.policy),a.passWayPoints&&(this.passWayPoints=a.passWayPoints),a.origin&&(this.origin=a.origin),a.policy&&(this.policy=a.policy),a.destination&&(this.destination=a.destination),a.panelId&&(this.panelId=a.panelId),a.callback&&(this.callback=a.callback))}function TYDistrictSearchOptions(a){this.code=null;this.lineColor="#00ff00";this.lineOpacity=this.lineWidth=1;this.fillColor="#ffffff";this.fillOpacity=1;this.isClearOverlay=this.isDrawArea=!0;this.callback=null;a&&(a.code&&(this.code=a.code),a.lineColor&&(this.lineColor=a.lineColor),a.lineWidth&&(this.lineWidth=a.lineWidth),void 0!=a.isClearOverlay&&(this.isClearOverlay=a.isClearOverlay),a.lineOpacity&&(this.lineOpacity=a.lineOpacity),a.fillColor&&(this.fillColor=a.fillColor),a.fillOpacity&&(this.fillOpacity=a.fillOpacity),void 0!=a.isDrawArea&&(this.isDrawArea=a.isDrawArea),a.callback&&(this.callback=a.callback))}function TYConvertOptions(a){this.lnglats=null;this.oType=TYEnumLngLatType.TY_GPS;this.tType=TYEnumLngLatType.TY_GCJ;a&&(a.lnglats&&(this.lnglats=a.lnglats),a.oType&&(this.oType=a.oType),a.tType&&(this.tType=a.tType))}function TYWeatherOptions(a){this.callback=this.district=null;a&&(a.district&&(this.district=a.district),a.callback&&(this.callback=a.callback))}function TYGeolocationOptions(a){this.showButton=!0;this.buttonPosition="LB";this.buttonOffset=new AMap.Pixel(10,20);this.zoomToAccuracy=this.panToLocation=this.showCircle=this.showMarker=!0;this.callback=null;a&&(a.showButton&&(this.showButton=a.showButton),a.buttonOffset&&(this.buttonOffset=a.buttonOffset),a.buttonPosition&&(this.buttonPosition=a.buttonPosition),void 0!=a.showMarker&&(this.showMarker=a.showMarker),void 0!=a.showCircle&&(this.showCircle=a.showCircle),void 0!=a.panToLocation&&(this.panToLocation=a.panToLocation),void 0!=a.zoomToAccuracy&&(this.zoomToAccuracy=a.zoomToAccuracy),a.callback&&(this.callback=a.callback))}function errorType(a,c){switch(a){case 1E4:console.log(a+":"+c);break;case 10001:console.log(a+":"+c)}}function TYMapRandomString(a){a=a||32;var c="";for(i=0;i<a;i++)c+="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678".charAt(Math.floor(48*Math.random()));return c}function TYSearchOptions(a){a&&(this.city=void 0,this.inCity=!1,this.pageType=[5,1],this.func=this.serach=this.panelId=void 0,a.city&&(this.city=a.city),1==a.inCity&&""!=a.city&&(this.inCity=a.inCity),a.pageType&&1<a.pageType.length&&(this.pageType=a.pageType),a.panelId&&(this.panelId=a.panelId),a.serach&&(this.search=a.serach),a.func&&(this.func=a.func))}var TYWMSTilesOptions=function(a){a&&(this.styles=this.layers=this.MapType=this.Id="",this.format="image/jpeg",this.transparent=!1,this.version="1.1.1",this.srs="EPSG:4326",this.url="",this.IsTile=!0,null!=a.IsTile&&(this.IsTile=a.IsTile),null!=a.Id&&(this.Id=a.Id),null!=a.MapType&&(this.MapType=a.MapType),null!=a.layers&&(this.layers=a.layers),null!=a.styles&&(this.styles=a.styles),null!=a.format&&(this.format=a.format),null!=a.transparent&&(this.transparent=a.transparent),null!=a.version&&(this.version=a.version),null!=a.srs&&(this.srs=a.srs),null!=a.url&&(this.url=a.url))};window._map=window._map||void 0;document.write(" \x3cstyle type\x3d'text/css'\x3e .amap-logo { right: 0 !important;left: auto !important;display: none;}.amap-copyright { right: auto ;left: 10px; }  .amap-marker-label{border:0px solid #00f ;background-color:transparent;}\x3c/style\x3e");var TYInitialize=function(a){_map&&(_map.destroy(),mousetool=void 0,_ty_cluster=null,_ty_cluster_markers={});var c,b,d;try{a&&(a.contentId?c=a.contentId:errorType(1E4,"\u5730\u56fe\u5bb9\u5668ID\u7f3a\u5931"),a.lnglat&&(b=a.lnglat),a.mapLevel&&(d=a.mapLevel),_map=b?new AMap.Map(c,{zoom:d,zooms:[3,18],expandZoomRange:!0,showIndoorMap:!1,resizeEnable:!0,center:[b.lng,b.lat]}):new AMap.Map(c,{zoom:d,zooms:[3,18],expandZoomRange:!0,showIndoorMap:!1,resizeEnable:!0})),_map.on("complete",function(){var a=document.getElementsByClassName("amap-copyright")[0],b;b="\x3cimg src\x3d'http://mapapi.tygps.com/Images/logo.png' style\x3d'width:25px;height:25px;'\x3e\x26nbsp;\u5929\u8fdc\u56fe \x3cspan style\x3d'font-family:Helvetica,'Hiragino Sans GB','Microsoft Yahei','\u5fae\u8f6f\u96c5\u9ed1',Arial;'\x3e\x26nbsp;\x26copy\x26nbsp;Powered By TianYuan."+a.innerText.substr(1,a.innerText.length-1);a.innerHTML=b+"\x3c/span\x3e";a.style="left:2px;bottom:8px"})}catch(e){console.log(e.message)}},_ty_view,_ty_tool,_ty_scale,TYMapConfig=function(a){if(a)try{void 0==_ty_view&&(_ty_view=new AMap.OverView),a.isShowOverView?(_ty_view.show(),_ty_view.open()):_ty_view.hide(),_map.addControl(_ty_view),void 0==_ty_tool&&(_ty_tool=new AMap.ToolBar),a.isShowControl?_ty_tool.show():_ty_tool.hide(),_map.addControl(_ty_tool),void 0==_ty_scale&&(_ty_scale=new AMap.Scale),a.isShowSale?_ty_scale.show():_ty_scale.hide(),_map.addControl(_ty_scale),_map.setStatus({animateEnable:a.isAnimate}),_map.setStatus({rotateEnable:a.isRotate}),_map.setStatus({dragEnable:a.isDrag}),_map.setStatus({zoomEnable:a.isZoom}),_map.setStatus({doubleClickZoom:a.isDoubleClickZoom}),_map.setStatus({keyboardEnable:a.isKeyboard}),_map.setStatus({jogEnable:a.isJog}),_map.setStatus({scrollWheel:a.isScrollWheel})}catch(c){console.log(c.message)}else void 0==_ty_view&&(_ty_view=new AMap.OverView),_ty_view.show(),_ty_view.open(),_map.addControl(_ty_view),void 0==_ty_tool&&(_ty_tool=new AMap.ToolBar),_ty_tool.show(),_map.addControl(_ty_tool),void 0==_ty_scale&&(_ty_scale=new AMap.Scale),_ty_scale.show(),_map.addControl(_ty_scale),_map.setStatus({animateEnable:!0}),_map.setStatus({rotateEnable:!0}),_map.setStatus({dragEnable:!0}),_map.setStatus({zoomEnable:!0}),_map.setStatus({doubleClickZoom:!0}),_map.setStatus({keyboardEnable:!0}),_map.setStatus({jogEnable:!0}),_map.setStatus({scrollWheel:!0})},TYSetCenter=function(a){if(a)try{_map.setCenter([a.lng,a.lat])}catch(c){console.log(c.message)}},TYSetLevel=function(a){if(a)try{_map.setZoom(a)}catch(c){console.log(c.message)}},TYSetFitView=function(){_map.setFitView()},TYSetLimitBounds=function(a){if(a)try{var c=new AMap.Bounds(a.b_l_lnglat,a.t_r_lnglat);_map.setLimitBounds(c)}catch(b){console.log(b.message)}},TYSetBounds=function(a){if(a)try{var c=new AMap.Bounds(a.b_l_lnglat,a.t_r_lnglat);_map.setBounds(c)}catch(b){console.log(b.message)}},TYBoundsClear=function(){_map&&_map.clearLimitBounds()},TYClear=function(a){a||(_ty_overlays=[]);_map.clearMap()},TYRemove=function(a){for(var c=_map.getAllOverlays(),b=0;b<c.length;b++)c[b].getExtData()&&c[b].getExtData()==a&&_map.remove(c[b]);_ty_cluster&&_ty_cluster_markers&&_ty_cluster.removeMarker(_ty_cluster_markers[a])},TYRemoveClusterMarkers=function(a){var c=[];if(_ty_cluster&&_ty_cluster_markers){for(var b=0;b<a.length;b++)c.push(_ty_cluster_markers[a[b]]);_ty_cluster.removeMarkers(c)}},TYAddMapEvent=function(a){AMap.event.addListener(_map,a.event,function(c){var b;c&&c.lnglat&&(b={location:new GPSLngLat(c.lnglat)});a.callback&&a.callback(b)})},TYHeatMap=function(a){a.heatMapState.isClearOverlay&&_map.clearMap();var c=new AMap.Heatmap(_map,{radius:a.heatMapData.radius,opacity:a.heatMapData.opacity,gradient:a.heatMapData.gradient});a.heatMapData.max?c.setDataSet({data:a.heatMapData.DataSet,max:a.heatMapData.max}):c.setDataSet({data:a.heatMapData.DataSet})},_ty_cluster,_ty_cluster_markers={},TYDrawPoint=function(a,c){if(a){var b=[];try{a.pointData||console.log("\u53c2\u6570\u7f3a\u5931");a.pointState.isClearOverlay&&(_ty_cluster&&(_ty_cluster.setMap(null),_ty_cluster=null,_ty_cluster_markers={}),TYClear(c));if(!c){var d=[];d.push("point");d.push(a);_ty_overlays.push(d)}d=[];a.pointData.length||0==a.pointData.length?d=a.pointData:d.push(a.pointData);a.pointData=d;for(d=0;d<a.pointData.length;d++){a.pointData[d].pointId||console.log("marker\u70b9ID\u7f3a\u5931");var e=new AMap.Marker({extData:a.pointData[d].pointId,icon:a.pointData[d].icon,position:a.pointData[d].lnglat,label:a.pointData[d].label,offset:a.pointData[d].offset,topWhenClick:!0});a.pointState.isGather&&b.push(e);e.setMap(_map);if(a.pointState.overlayEvent)e.on(a.pointState.overlayEvent.mouseEvent,function(b){b=b.target;var d={};d.GPSLngLat=new GPSLngLat(b.getPosition());d.icon=b.getIcon();d.pointId=b.getExtData();d.label=b.getLabel();d.offset=[b.getOffset().getX(),b.getOffset().getY()];a.pointState.overlayEvent.mouseFunc(d)});_ty_cluster_markers[a.pointData[d].pointId]=e}a.pointState.isGather&&(a.pointState.isSetView&&_map.setFitView(),_ty_cluster?_ty_cluster.addMarkers(b):_map.plugin(["AMap.MarkerClusterer"],function(){_ty_cluster=new AMap.MarkerClusterer(_map,b,{maxZoom:17})}));a.pointState.isSetView&&(0!=b.length?_map.setFitView(b):_map.setFitView());if(_ty_cluster)return _ty_cluster}catch(f){console.log(f.message)}}},TYDrawLine=function(a,c){if(a)try{a.lineData||console.log("\u53c2\u6570\u7f3a\u5931");a.lineState.isClearOverlay&&TYClear(c);if(!c){var b=[];b.push("line");b.push(a);_ty_overlays.push(b)}b=[];a.lineData.length?b=a.lineData:b.push(a.lineData);a.lineData=b;for(var d in a.lineData){a.lineData[d].lineId||console.log(a.lineData[d].lineId+"line\u56fe\u5f62ID\u7f3a\u5931");var e=new AMap.Polyline({extData:a.lineData[d].lineId,path:a.lineData[d].lnglat,strokeColor:a.lineData[d].lineColor,strokeOpacity:a.lineData[d].lineOpacity,strokeWeight:a.lineData[d].lineWidth,strokeStyle:a.lineData[d].lineType});if(a.lineState.overlayEvent)e.on(a.lineState.overlayEvent.mouseEvent,function(b){var d=b.target,c={};c.lineId=d.getExtData();var d=d.getPath(),e=[],f;for(f in d)e.push(new GPSLngLat(d[f]));c.lnglat=e;b=GPS.gcj_decrypt(b.lnglat.lat,b.lnglat.lng);c.mouseLnglat={lng:b.lng,lat:b.lat};a.lineState.overlayEvent.mouseFunc&&a.lineState.overlayEvent.mouseFunc(c)});a.lineData[d].isEdit&&_map.plugin(["AMap.PolyEditor"],function(){(new AMap.PolyEditor(_map,e)).open()});e.setMap(_map)}a.lineState.isSetView&&_map.setFitView()}catch(f){console.log(f.message)}},TYDrawRectangle=function(a,c){if(a)try{a.rectangleData||console.log("\u53c2\u6570\u7f3a\u5931");a.rectangleState.isClearOverlay&&TYClear(c);if(!c){var b=[];b.push("rect");b.push(a);_ty_overlays.push(b)}b=[];a.rectangleData.length?b=a.rectangleData:b.push(a.rectangleData);a.rectangleData=b;for(var d in a.rectangleData){a.rectangleData[d].rectangleId||console.log("\u77e9\u5f62\u56fe\u5f62ID\u7f3a\u5931");var e,f;e=a.rectangleData[d].t_r_LngLat;f=a.rectangleData[d].b_l_LngLat;var g=new AMap.Polygon({extData:a.rectangleData[d].rectangleId,path:[[e.lng,f.lat],e,[f.lng,e.lat],f],strokeColor:a.rectangleData[d].lineColor,strokeOpacity:a.rectangleData[d].lineOpacity,strokeWeight:a.rectangleData[d].lineWidth,fillColor:a.rectangleData[d].fillColor,fillOpacity:a.rectangleData[d].fillOpacity});if(a.rectangleState.overlayEvent)g.on(a.rectangleState.overlayEvent.mouseEvent,function(b){var d={},c=b.target.getPath(),e=[],f;for(f in c)e.push(new GPSLngLat(c[f]));d.GPSLngLat=e;d.rectangleId=b.target.getExtData();a.rectangleState.overlayEvent.mouseFunc&&a.rectangleState.overlayEvent.mouseFunc(d)});a.rectangleData[d].isEdit&&_map.plugin(["AMap.PolyEditor"],function(){(new AMap.PolyEditor(_map,g)).open()});g.setMap(_map)}a.rectangleState.isSetView&&_map.setFitView()}catch(h){console.log(h.message)}},TYDrawPolygon=function(a,c){if(a)try{a.polygonData||console.log("\u53c2\u6570\u7f3a\u5931");a.polygonState.isClearOverlay&&TYClear(c);if(!c){var b=[];b.push("polygon");b.push(a);_ty_overlays.push(b)}b=[];a.polygonData.length?b=a.polygonData:b.push(a.polygonData);a.polygonData=b;for(var d in a.polygonData){a.polygonData[d].polygonId||console.log("\u591a\u8fb9\u5f62\u56fe\u5f62ID\u7f3a\u5931");var e=new AMap.Polygon({extData:a.polygonData[d].polygonId,path:a.polygonData[d].lnglat,strokeColor:a.polygonData[d].lineColor,strokeOpacity:a.polygonData[d].lineOpacity,strokeWeight:a.polygonData[d].lineWidth,fillColor:a.polygonData[d].fillColor,fillOpacity:a.polygonData[d].fillOpacity});if(a.polygonState.overlayEvent)e.on(a.polygonState.overlayEvent.mouseEvent,function(b){var d={},c=b.target.getPath(),e=[],f;for(f in c)e.push(new GPSLngLat(c[f]));d.GPSLngLat=e;d.polygonId=b.target.getExtData();a.polygonState.overlayEvent.mouseFunc(d)});a.polygonData[d].isEdit&&_map.plugin(["AMap.PolyEditor"],function(){(new AMap.PolyEditor(_map,e)).open()});e.setMap(_map)}a.polygonState.isSetView&&_map.setFitView()}catch(f){console.log(f.message)}},TYDrawCircle=function(a,c){if(a)try{a.circleData||console.log("\u53c2\u6570\u7f3a\u5931");a.circleState.isClearOverlay&&TYClear(c);if(!c){var b=[];b.push("circle");b.push(a);_ty_overlays.push(b)}b=[];a.circleData.length?b=a.circleData:b.push(a.circleData);a.circleData=b;for(var d in a.circleData){a.circleData[d].circleId||console.log("\u591a\u8fb9\u5f62\u56fe\u5f62ID\u7f3a\u5931");var e=new AMap.Circle({extData:a.circleData[d].circleId,center:a.circleData[d].lnglat,radius:a.circleData[d].radius,strokeColor:a.circleData[d].lineColor,strokeOpacity:a.circleData[d].lineOpacity,strokeWeight:a.circleData[d].lineWidth,fillColor:a.circleData[d].fillColor,fillOpacity:a.circleData[d].fillOpacity});if(a.circleState.overlayEvent)e.on(a.circleState.overlayEvent.mouseEvent,function(b){var d={};d.circleId=b.target.getExtData();d.GPSLngLat=new GPSLngLat(b.target.getCenter());d.radius=b.target.getOptions().radius;a.circleState.overlayEvent.mouseFunc(d)});a.circleData[d].isEdit&&_map.plugin(["AMap.CircleEditor"],function(){(new AMap.CircleEditor(_map,e)).open()});e.setMap(_map)}a.circleState.isSetView&&_map.setFitView()}catch(f){console.log(f.message)}},mousetool,dr,TYDrawOverlay=function(a){if(a)try{a.overlayType||console.log("\u624b\u7ed8\u70b9\u7ebf\u9762\u53c2\u6570\u7f3a\u5931"),a.isClearOverlay&&TYClear(),_map.setDefaultCursor("crosshair"),_map.plugin(["AMap.MouseTool"],function(){dr&&AMap.event.removeListener(dr);a.overlayType==TYEnumOverLay.TY_POINT?(mousetool||(mousetool=new AMap.MouseTool(_map)),mousetool.marker(),dr=AMap.event.addListener(mousetool,"draw",function(c){var b="DPoint"+TYMapRandomString(6);c.obj.setExtData(b);var d={},e=c.obj.getPosition();d.GPSLngLat=new GPSLngLat(e);d.Id=b;a.callfunc&&a.callfunc(d);a.isShowMath&&c.obj.setLabel({offset:new AMap.Pixel(25,5),content:"\x3cdiv style\x3d'color:red'\x3e\u7ecf\u5ea6:"+d.GPSLngLat.GPSLng+",\u7eac\u5ea6"+d.GPSLngLat.GPSLat+"\x3c/div\x3e"});b=new TYMarker({lnglat:e,pointId:b});c=new TYPointOption;c.pointData=b;c.pointState.isClearOverlay=!1;c.pointState.isSetView=!1;b=[];b.push("point");b.push(c);_ty_overlays.push(b)})):a.overlayType==TYEnumOverLay.TY_POLYLINE?(mousetool||(mousetool=new AMap.MouseTool(_map)),a.isShowMath?mousetool.rule({strokeColor:"#44A6FA"}):mousetool.polyline({strokeColor:"#44A6FA"}),dr=AMap.event.addListener(mousetool,"draw",function(c){var b=c.obj,d="DPolyline"+TYMapRandomString(6);c.obj.setExtData(d);c=b.getPath();var e=[],f;for(f in c)e.push(new GPSLngLat(c[f]));f={};f.GPSLngLat=e;f.length=b.getLength();f.Id=d;a.callfunc&&a.callfunc(f);b=new TYLine;b.lineOpacity=.7;b.lineType="solid";b.lineId=d;b.lineWidth=3;b.lineColor="#44A6FA";var d=[],g;for(g in e)d.push(new TYLngLat(e[g].GPSLng,e[g].GPSLat));b.lnglat=c;f=new TYLineOption;f.lineData=b;f.lineState.isClearOverlay=!1;f.lineState.isSetView=!1;g=[];g.push("line");g.push(f);_ty_overlays.push(g)})):a.overlayType==TYEnumOverLay.TY_CIRCLE?(mousetool||(mousetool=new AMap.MouseTool(_map)),mousetool.circle({fillColor:"#44A6FA",fillOpacity:.6,lineColor:"#44A6FA",lineOpacity:1,lineWidth:3}),dr=AMap.event.addListener(mousetool,"draw",function(c){if(1!=c.obj.getRadius()){var b="DCircle"+TYMapRandomString(6);c.obj.setExtData(b);var d=c.obj.getRadius();c=c.obj.getCenter();var e=new GPSLngLat(c),f={};f.GPSLngLat=e;f.radius=d;f.Id=b;f.area=d*d*Math.PI;(a.isShowMath?new AMap.Marker({label:{offset:new AMap.Pixel(15,-5),content:"\x3cdiv style\x3d'color:red'\x3e\u534a\u5f84:"+d+"\u7c73\x3cbr\x3e\u7ecf\u5ea6:"+f.GPSLngLat.GPSLng+",\u7eac\u5ea6:"+f.GPSLngLat.GPSLat+"\x3c/div\x3e"},offset:new AMap.Pixel(-6,-6),position:c,icon:"http://webapi.amap.com/images/dd-via.png"}):new AMap.Marker({offset:new AMap.Pixel(-6,-6),position:c,icon:"http://webapi.amap.com/images/dd-via.png"})).setMap(_map);a.callfunc&&a.callfunc(f);e=new TYCircle;e.circleId=b;e.fillColor="#44A6FA";e.fillOpacity=.6;e.lineColor="#44A6FA";e.lineOpacity=1;e.lineWidth=3;e.lnglat=c;e.radius=d;b=new TYCircleOption;b.circleData=e;b.circleState.isSetView=!1;b.circleState.isClearOverlay=!1;d=[];d.push("circle");d.push(b);_ty_overlays.push(d)}})):a.overlayType==TYEnumOverLay.TY_POLYGON?(mousetool||(mousetool=new AMap.MouseTool(_map)),mousetool.polygon({fillColor:"#44A6FA",fillOpacity:.7,lineColor:"#44A6FA",lineOpacity:1,lineWidth:3}),a.isShowMath&&mousetool.measureArea(),dr=AMap.event.addListener(mousetool,"draw",function(c){var b=c.obj.getPath(),d="DPolypon"+TYMapRandomString(6);c.obj.setExtData(d);var e=[],f;for(f in b)e.push(new GPSLngLat(b[f]));f={};f.Id=d;f.GPSLngLat=e;f.area=c.obj.getArea();a.callfunc&&a.callfunc(f);c=new TYPolygon;c.fillColor="#44A6FA";c.fillOpacity=.6;c.lineColor="#44A6FA";c.lineOpacity=1;c.lineWidth=3;c.polygonId=d;c.lnglat=b;b=new TYPolygonOption;b.polygonData=c;b.polygonState.isClearOverlay=!1;b.polygonState.isSetView=!1;d=[];d.push("polygon");d.push(b);_ty_overlays.push(d)})):a.overlayType==TYEnumOverLay.TY_RECTANGLE&&(mousetool||(mousetool=new AMap.MouseTool(_map)),mousetool.rectangle({fillColor:"#44A6FA",fillOpacity:.6,lineColor:"#44A6FA",lineOpacity:1,lineWidth:3}),dr=AMap.event.addListener(mousetool,"draw",function(c){var b=c.obj,d="DRectangle"+TYMapRandomString(6);c.obj.setExtData(d);if(0!=b.getArea()){c=b.getPath();var e=c[0].lng-(c[0].lng-c[1].lng)/2,f=c[0].lat-(c[0].lat-c[3].lat)/2;a.isShowMath&&(new AMap.Marker({label:{offset:new AMap.Pixel(15,-5),content:"\x3cdiv style\x3d'color:red'\x3e\u9762\u79ef:"+b.getArea()+"\u5e73\u65b9\u7c73\x3c/div\x3e"},offset:new AMap.Pixel(-6,-6),position:[e,f],icon:"http://webapi.amap.com/images/dd-via.png"})).setMap(_map);var e=[],g;for(g in c)e.push(new GPSLngLat(c[g]));g={};g.GPSLngLat=e;g.area=b.getArea();g.Id=d;a.callfunc&&a.callfunc(g);b=new TYPolygon;b.fillColor="#44A6FA";b.fillOpacity=.6;b.lineColor="#44A6FA";b.lineOpacity=1;b.lineWidth=3;b.lnglat=c;b.polygonId=d;d=new TYPolygonOption;d.polygonData=b;d.polygonState.isClearOverlay=!1;d.polygonState.isSetView=!1;b=[];b.push("polygon");b.push(d);_ty_overlays.push(b)}}))})}catch(c){console.log(c.message)}},TYDrawStop=function(a){1==a&&_map&&TYClear();mousetool&&mousetool.close(a);_map&&_map.setDefaultCursor()},TYInfoWindowClose=function(){_ty_infoWindow&&_ty_infoWindow.close()},_ty_infoWindow,TYInfoWindow=function(a){if(a)try{a.position||console.log("\u5f39\u51fa\u6846\u53c2\u6570\u7f3a\u5931");var c,b,d,e,f,g;c=a.isCustom;b=a.enableCloseOnClick;a.offset&&(d=a.offset);e=a.showShadow;a.position&&(f=a.position);a.content&&(g=a.content);_ty_infoWindow=new AMap.InfoWindow({showShadow:e,offset:d,closeWhenClickMap:b,isCustom:c,content:a.isCustom?g:"\x3cdiv  class\x3d'info-lu'\x3e"+g+"\x3c/div\x3e"});_ty_infoWindow.open(_map,f)}catch(h){console.log(h.message)}},TYSpAsis=function(a){if(a)try{if(a.sisType||console.log("\u7a7a\u95f4\u8ba1\u7b97\u53c2\u6570\u7f3a\u5931"),a.sisType==TYEnumSpAsis.P_PGON){if(a.point&&a.polyGon){var c=new AMap.Polygon({path:a.polyGon});return c.contains(a.point)}console.log("\u8ba1\u7b97\u7f3a\u5c11\u53c2\u6570")}else if(a.sisType==TYEnumSpAsis.LINE_SIS){if(a.polyLine){for(var b=c=0;b<a.polyLine.length-1;b++)c+=a.polyLine[b].distance(a.polyLine[b+1]);return c}console.log("\u8ba1\u7b97\u7f3a\u5c11\u53c2\u6570")}else if(a.sisType==TYEnumSpAsis.PLOYGON_SIS){if(a.polyGon)return c=new AMap.Polygon({path:a.polyGon}),c.getArea();console.log("\u8ba1\u7b97\u7f3a\u5c11\u53c2\u6570")}}catch(d){console.log(d.message)}},TYGetLocation=function(a){if(a)try{a.callback&&a.address&&""!=a.address.replace(/\s/g,"")||console.log("\u5730\u7406\u7f16\u7801\u53c2\u6570\u7f3a\u5931"),(new AMap.Geocoder({radius:3E3})).getLocation(a.address,function(c,b){if("complete"===c&&"OK"===b.info){for(var d=[],e=b.geocodes,f=0;f<e.length;f++){var g={adress:e[f].formattedAddress,province:e[f].addressComponent.province,city:e[f].addressComponent.city,citycode:e[f].addressComponent.citycode,district:e[f].addressComponent.district,GPSLngLat:new GPSLngLat(e[f].location),acode:e[f].adcode,township:e[f].addressComponent.township,street:e[f].addressComponent.street};d.push(g)}d={status:!0,count:e.length,geocodes:d};a.callback&&a.callback(d)}else console.log("\u89e3\u6790\u5931\u8d25")})}catch(c){console.log(c.message)}},TYGeoCoder=function(a){if(a)try{a.callback&&a.location||console.log("\u9006\u5411\u5730\u7406\u7f16\u7801\u53c2\u6570\u7f3a\u5931");var c=new AMap.Geocoder({extensions:"all",radius:1E3}),b=[];a.batch?b=a.location:b.push(a.location[0]);c.getAddress(b,function(b,c){if("complete"===b&&"OK"===c.info){for(var d=[],e,h=c.regeocodes,k=0;k<h.length;k++){var l=e="",m="",n="",r="",t="",q="",u="",v;h[k].pois[0]&&(h[k].pois[0].name&&(e=h[k].pois[0].name),h[k].pois[0].distance&&(m=h[k].pois[0].distance),h[k].pois[0].distance&&(l=h[k].pois[0].direction),h[k].pois[0].location&&(v=new GPSLngLat(h[k].pois[0].location)));h[k].addressComponent&&(h[k].addressComponent.street&&(n=h[k].addressComponent.street),h[k].addressComponent.province&&(r=h[k].addressComponent.province),h[k].addressComponent.city&&(t=h[k].addressComponent.city),h[k].addressComponent.township&&(q=h[k].addressComponent.township),h[k].addressComponent.district&&(u=h[k].addressComponent.district));var p=r+t+u;a.type==TYEnumGeocoder.TY_EXACT_DESC?(e&&(p+=e),l&&(p+="\u5411"+l),m&&(p+=m+"\u7c73")):a.type==TYEnumGeocoder.TY_NEAR_DESC?(q&&(p+=q),e&&(p+=e+"\u9644\u8fd1")):a.type==TYEnumGeocoder.TY_ROAD_DESC&&(n&&(p+=n),q&&(p+=q+"\u9644\u8fd1"));e={description:p,Poi:e,direction:l,distance:m,province:r,city:t,township:q,street:n,district:u,GPSLngLat:v};d.push(e)}d={status:!0,geocodes:d};a.callback&&a.callback(d)}else console.log("\u9006\u5411\u89e3\u6790\u5931\u8d25")})}catch(d){console.log(d.message)}},TYWeather=function(a){var c=a.district,b=a.callback;AMap.service("AMap.Weather",function(){(new AMap.Weather).getLive(c,function(a,c){var d={status:!1};a||(d.status=!0,d.city=c.city,d.weather=c.weather,d.temperature=c.temperature,d.windDirection=c.windDirection,d.windPower=c.windPower,d.humidity=c.humidity,d.reportTime=c.reportTime);b&&b(d)})})},TYconvertFrom=function(a){if(a)try{if(a.lnglats[0][1]){for(var c=[],b=0;b<a.lnglats.length;b++)c.push(convertLngLat(a.oType,a.tType,a.lnglats[b]));return c}return convertLngLat(a.oType,a.tType,a.lnglats)}catch(d){console.log(d.message)}else console.log("\u53c2\u6570\u7f3a\u5931")};function convertLngLat(a,c,b){if(1==a)switch(c){case 2:return a=GPS.gcj_encrypt(Number(b[1]),Number(b[0])),[a.lng,a.lat];case 3:return a=GPS.gcj_encrypt(Number(b[1]),Number(b[0])),a=GPS.bd_encrypt(a.lat,a.lng),[a.lng,a.lat]}else if(2==a)switch(c){case 1:return a=GPS.gcj_decrypt(Number(b[1]),Number(b[0])),[a.lng,a.lat];case 3:return a=GPS.bd_encrypt(Number(b[1]),Number(b[0])),[a.lng,a.lat]}else if(3==a)switch(c){case 1:return a=GPS.bd_decrypt(Number(b[1]),Number(b[0])),a=GPS.gcj_decrypt(a.lat,a.lng),[a.lng,a.lat];case 2:return a=GPS.bd_decrypt(Number(b[1]),Number(b[0])),[a.lng,a.lat]}}var GPS={PI:3.141592653589793,x_pi:52.35987755982988,delta:function(a,c){var b=this.transformLat(c-105,a-35),d=this.transformLon(c-105,a-35),e=a/180*this.PI,f=Math.sin(e),f=1-.006693421622965943*f*f,g=Math.sqrt(f),b=180*b/(6335552.717000426/(f*g)*this.PI),d=180*d/(6378245/g*Math.cos(e)*this.PI);return{lat:b,lng:d}},gcj_encrypt:function(a,c){if(this.outOfChina(a,c))return new TYLngLat_Normal(c,a);var b=this.delta(a,c);return new TYLngLat_Normal(c+b.lng,a+b.lat)},gcj_decrypt:function(a,c){if(this.outOfChina(a,c))return new TYLngLat_Normal(c,a);var b=this.delta(a,c);return new TYLngLat_Normal(c-b.lng,a-b.lat)},gcj_decrypt_exact:function(a,c){for(var b=.01,d=.01,e=a-b,f=c-d,g=a+b,h=c+d,k,l,m=0;;){k=(e+g)/2;l=(f+h)/2;d=this.gcj_encrypt(k,l);b=d.lat-a;d=d.lng-c;if(1E-9>Math.abs(b)&&1E-9>Math.abs(d))break;0<b?g=k:e=k;0<d?h=l:f=l;if(1E4<++m)break}return new TYLngLat_Normal(l,k)},bd_encrypt:function(a,c){var b=Math.sqrt(c*c+a*a)+2E-5*Math.sin(a*this.x_pi),d=Math.atan2(a,c)+3E-6*Math.cos(c*this.x_pi);bdLon=b*Math.cos(d)+.0065;bdLat=b*Math.sin(d)+.006;return{lat:bdLat,lng:bdLon}},bd_decrypt:function(a,c){var b=c-.0065,d=a-.006,e=Math.sqrt(b*b+d*d)-2E-5*Math.sin(d*this.x_pi),b=Math.atan2(d,b)-3E-6*Math.cos(b*this.x_pi);return{lat:e*Math.sin(b),lng:e*Math.cos(b)}},distance:function(a,c,b,d){a=Math.cos(a*Math.PI/180)*Math.cos(b*Math.PI/180)*Math.cos((c-d)*Math.PI/180)+Math.sin(a*Math.PI/180)*Math.sin(b*Math.PI/180);1<a&&(a=1);-1>a&&(a=-1);return 6371E3*Math.acos(a)},outOfChina:function(a,c){return 72.004>c||137.8347<c||.8293>a||55.8271<a?!0:!1},transformLat:function(a,c){var b=-100+2*a+3*c+.2*c*c+.1*a*c+.2*Math.sqrt(Math.abs(a)),b=b+2*(20*Math.sin(6*a*this.PI)+20*Math.sin(2*a*this.PI))/3,b=b+2*(20*Math.sin(c*this.PI)+40*Math.sin(c/3*this.PI))/3;return b+=2*(160*Math.sin(c/12*this.PI)+320*Math.sin(c*this.PI/30))/3},transformLon:function(a,c){var b=300+a+2*c+.1*a*a+.1*a*c+.1*Math.sqrt(Math.abs(a)),b=b+2*(20*Math.sin(6*a*this.PI)+20*Math.sin(2*a*this.PI))/3,b=b+2*(20*Math.sin(a*this.PI)+40*Math.sin(a/3*this.PI))/3;return b+=2*(150*Math.sin(a/12*this.PI)+300*Math.sin(a/30*this.PI))/3}};function TYDistrictSearch(a,c){try{(new AMap.DistrictSearch({subdistrict:0,extensions:"all"})).search(a.code,function(b,d){var e={status:!1};if("complete"==b){e.status=!0;e.district={};var f=d.districtList[0].boundaries,g=[],h=[],k;for(k in f){for(var l in f[k])h.push(new GPSLngLat(f[k][l]));g.push(h)}e.district.polyine=g;e.district.citycode=d.districtList[0].citycode;e.district.adcode=d.districtList[0].adcode;e.district.name=d.districtList[0].name;e.district.center=d.districtList[0].center;if(a.isDrawArea&&(a.isClearOverlay&&TYClear(c),c||(f=[],f.push("TYDistrictSearch"),f.push(a),_ty_overlays.push(f)),d.districtList[0].boundaries)){if(12<=_ty_tileType)for(f=0,g=d.districtList[0].boundaries.length;f<g;f++)for(h=0;h<d.districtList[0].boundaries[f].length;h++)d.districtList[0].boundaries[f][h]=GPS.gcj_decrypt(d.districtList[0].boundaries[f][h].lat,d.districtList[0].boundaries[f][h].lng);f=0;for(g=d.districtList[0].boundaries.length;f<g;f++)new AMap.Polygon({map:_map,strokeColor:a.lineColor,strokeOpacity:a.lineOpacity,strokeWeight:a.lineWidth,fillColor:a.fillColor,fillOpacity:a.fillOpacity,path:d.districtList[0].boundaries[f]});_map.setFitView()}}a.callback&&a.callback(e)})}catch(b){console.log(b.message)}}var _ty_driving=!1,TYDriving=function(a,c){_ty_driving=!0;try{a.panelId&&(document.getElementById(a.panelId).innerHTML=""),(new AMap.Driving({policy:a.policy,map:_map,panel:a.panelId})).search(a.origin,a.destination,{waypoints:a.passWayPoints},function(b,d){var c={status:!1};if(a.callback&&""!=a.callback&&"complete"==b){c.status=!0;c.origin=d.origin;c.destination=d.destination;var f={};f.policy=d.routes[0].policy;f.distance=d.routes[0].distance;f.time=d.routes[0].time;f.steps=[];for(var g=[],h=0;h<d.routes[0].steps.length;h++){var k={};k.start_location=new GPSLngLat(d.routes[0].steps[h].start_location);k.end_location=new GPSLngLat(d.routes[0].steps[h].end_location);k.instruction=d.routes[0].steps[h].instruction;k.action=d.routes[0].steps[h].action;k.orientation=d.routes[0].steps[h].orientation;k.road=d.routes[0].steps[h].road;k.distance=d.routes[0].steps[h].distance;k.time=d.routes[0].steps[h].time;var l=d.routes[0].steps[h].path,m=[],n;for(n in l)m.push(new GPSLngLat(l[n]));k.path=m;f.steps.push(k);g=g.concat(m)}c.paths=g;c.routes=f}a.callback&&a.callback(c)})}catch(b){console.log(b.message)}},_areaTitlRender=[],TYAreaRender=function(a,c){try{var b="100000",d=a.renderDatas;"0000"==d[0].renderId.substr(2,4)?b="101":"00"==d[0].renderId.substr(4,2)&&(b="102");var e=a.renderState;if(e.isClearOverlay&&0<_areaTitlRender.length){for(var f=0;f<_areaTitlRender.length;f++)_areaTitlRender[f].setMap(null);TYClear(c)}if(!c){var g=[];g.push("TYAreaRender");g.push(a);_ty_overlays.push(g)}var h=g="",k="";for(f in d)g+=d[f].renderId+",",h+=d[f].fillColor.replace("#","")+",",k+=d[f].borderColor.replace("#","")+",",d[f].icon&&""!=d[f].icon&&_addAreaMarker(d[f],e.overlayEvent);g=g.substring(0,g.length-1);h=h.substring(0,h.length-1);k=k.substring(0,k.length-1);_addAreaRender(h,k,g,b);.4<e.tileOpacity&&_addAreaRender(h,k,g,b);.6<e.tileOpacity&&_addAreaRender(h,k,g,b);e.isSetView&&(_map.setFitView(),"0000"==d[0].renderId.substr(2,4)?TYSetLevel(6):"00"==d[0].renderId.substr(4,2)&&TYSetLevel(8))}catch(l){console.log(l.message)}};function _addAreaMarker(a,c){var b=new AMap.Marker({icon:a.icon,map:_map,position:a.lnglat});a.label&&""!=a.label&&b.setLabel(a.label);if(c&&""!=c)b.on(c.mouseEvent,function(b){b=new TYLngLat_Reverse(a.lnglat.lng,a.lnglat.lat);a.lnglat=b;c.mouseFunc&&c.mouseFunc(a)})}function _addAreaRender(a,c,b,d){var e=new AMap.TileLayer({zIndex:3,tileSize:256,id:TYMapRandomString(8),getTileUrl:function(e,g,h){return"http://api4.tygps.com:8080/sisserver?config\x3dDISTRICTRENDER\x26userId\x3d"+d+"\x26zoom\x3d"+h+"\x26x\x3d"+e+"\x26y\x3d"+g+"\x26areacode\x3d"+b+"\x26areacolor\x3d"+a+"\x26areaoutlinecolor\x3d"+c+"\x26a_k\x3d2b592e22ba43480912bf4063a7f082af2d7cfe858d396f9047754b91e68d992920b521280cd9d351"}});e.setMap(_map);_areaTitlRender.push(e)}var _ty_locus,TYMoveLocus=function(a,c){a.locusData&&a.locusData.lnglat[0]&&a.locusData.lnglat[0].equals(a.locusData.lnglat[a.locusData.lnglat.length-1])&&(a.locusData.lnglat[a.locusData.lnglat.length-1]=new AMap.LngLat(a.locusData.lnglat[0].getLng(),a.locusData.lnglat[0].getLat()+1E-5));_ty_locus&&(console.log(_ty_locus._intervalFlag),_ty_locus.stop(),AMap.event.removeListener(_ty_locus.zoomChange),AMap.event.removeListener(_ty_locus.dragStart),AMap.event.removeListener(_ty_locus.dragEnd),TYClear(),_ty_locus=null);try{var b=a.locusState,d=a.locusData;b.isClearOverlay&&TYClear(c);if(!c){var e=[];e.push("TYMoveLocus");e.push(a);_ty_overlays.push(e)}_TYDrawLinesAndMarkers(d,b);_ty_locus=new TYMapLib.TYTrack(_map,d.lnglat,{defaultContent:d.label,autoView:b.isSetView,icon:b.carIcon,speed:b.moveSpeed,enableRotation:!0,circlable:b.circlable,func:b.syncEvent});_ty_locus.zoomChange=AMap.event.addListener(_map,"zoomchange",function(){if(_ty_locus.ismove){var a=_ty_locus.i;a==_ty_locus._path.length-1&&"true"==_ty_locus._opts.circlable&&(a=0);clearInterval(_ty_locus._intervalFlag);_ty_locus._move(_ty_locus._path[a],_ty_locus._path[a+1],_ty_locus._tween.linear,_ty_locus._cc)}});_ty_locus.dragStart=AMap.event.addListener(_map,"dragstart",function(){_ty_locus.ismove&&clearInterval(_ty_locus._intervalFlag)});_ty_locus.dragEnd=AMap.event.addListener(_map,"dragend",function(){if(_ty_locus.ismove){var a=_ty_locus.i;a==_ty_locus._path.length-1&&"true"==_ty_locus._opts.circlable&&(a=0);_ty_locus._move(_ty_locus._path[a],_ty_locus._path[a+1],_ty_locus._tween.linear,_ty_locus._cc)}})}catch(f){console.log(f.message)}};function TYLocusStart(){_ty_locus&&_ty_locus.start()}function TYLocusStop(){_ty_locus&&_ty_locus.stop()}function TYLocusPause(){_ty_locus&&(_ty_locus.pause(),_ty_locus.ismove=!1)}function TYLocusSetIndex(a){_ty_locus&&a&&_ty_locus.setIndex(a)}function _TYDrawLinesAndMarkers(a,c){var b=a.lnglat;if(a.nodeIcon&&""!=a.nodeIcon)for(var d in b)(new AMap.Marker({icon:a.nodeIcon,map:_map,position:b[d]})).on(c.overlayEvent.mouseEvent,function(a){a=new GPSLngLat(a.target.getPosition());c&&c.overlayEvent.mouseFunc(a)});b=new AMap.Polyline({map:_map,path:b,strokeColor:a.lineColor,strokeOpacity:a.lineOpacity,strokeWeight:a.lineWidth,strokeStyle:a.lineType});if(c&&c.overlayEvent&&c.overlayEvent.mouseEvent)b.on(c.overlayEvent.mouseEvent,function(a){a=new GPSLngLat(a.lnglat);c&&c.overlayEvent.mouseFunc(a)});_map.setFitView()}function _TYRe(a,c){var b=_map.getCenter(),b=c?GPS.gcj_decrypt(b.lat,b.lng):GPS.gcj_encrypt(b.lat,b.lng);_map.panTo(b);switch(a[0]){case "TYDistrictSearch":TYDistrictSearch(a[1],!0);break;case "point":if(c)if(a[1].pointData.length)for(var d=0;d<a[1].pointData.length;d++)a[1].pointData[d].lnglat=GPS.gcj_decrypt(a[1].pointData[d].lnglat.lat,a[1].pointData[d].lnglat.lng);else a[1].pointData.lnglat=GPS.gcj_decrypt(a[1].pointData.lnglat.lat,a[1].pointData.lnglat.lng);else if(a[1].pointData.length)for(d=0;d<a[1].pointData.length;d++)a[1].pointData[d].lnglat=GPS.gcj_encrypt(a[1].pointData[d].lnglat.lat,a[1].pointData[d].lnglat.lng);else a[1].pointData.lnglat=GPS.gcj_encrypt(a[1].pointData.lnglat.lat,a[1].pointData.lnglat.lng);a[1].pointState.isSetView=!1;TYDrawPoint(a[1],!0);break;case "line":if(c)if(a[1].lineData.length)for(d=0;d<a[1].lineData.length;d++)for(b=0;b<a[1].lineData[d].lnglat.length;b++)a[1].lineData[d].lnglat[b]=GPS.gcj_decrypt(a[1].lineData[d].lnglat[b].lat,a[1].lineData[d].lnglat[b].lng);else for(b=0;b<a[1].lineData.lnglat.length;b++)a[1].lineData.lnglat[b]=GPS.gcj_decrypt(a[1].lineData.lnglat[b].lat,a[1].lineData.lnglat[b].lng);else if(a[1].lineData.length)for(d=0;d<a[1].lineData.length;d++)for(b=0;b<a[1].lineData[d].lnglat.length;b++)a[1].lineData[d].lnglat[b]=GPS.gcj_encrypt(a[1].lineData[d].lnglat[b].lat,a[1].lineData[d].lnglat[b].lng);else for(b=0;b<a[1].lineData.lnglat.length;b++)a[1].lineData.lnglat[b]=GPS.gcj_encrypt(a[1].lineData.lnglat[b].lat,a[1].lineData.lnglat[b].lng);a[1].lineState.isSetView=!1;TYDrawLine(a[1],!0);break;case "rect":if(c)if(a[1].rectangleData.length)for(d=0;d<a[1].rectangleData.length;d++)a[1].rectangleData[d].t_r_LngLat=GPS.gcj_decrypt(a[1].rectangleData[d].t_r_LngLat.lat,a[1].rectangleData[d].t_r_LngLat.lng),a[1].rectangleData[d].b_l_LngLat=GPS.gcj_decrypt(a[1].rectangleData[d].b_l_LngLat.lat,a[1].rectangleData[d].b_l_LngLat.lng);else a[1].rectangleData[d].t_r_LngLat=GPS.gcj_decrypt(a[1].rectangleData.t_r_LngLat.lat,a[1].rectangleData.t_r_LngLat.lng),a[1].rectangleData[d].b_l_LngLat=GPS.gcj_decrypt(a[1].rectangleData.b_l_LngLat.lat,a[1].rectangleData.b_l_LngLat.lng);else if(a[1].rectangleData.length)for(d=0;d<a[1].rectangleData.length;d++)a[1].rectangleData[d].t_r_LngLat=GPS.gcj_encrypt(a[1].rectangleData[d].t_r_LngLat.lat,a[1].rectangleData[d].t_r_LngLat.lng),a[1].rectangleData[d].b_l_LngLat=GPS.gcj_encrypt(a[1].rectangleData[d].b_l_LngLat.lat,a[1].rectangleData[d].b_l_LngLat.lng);else a[1].rectangleData[d].t_r_LngLat=GPS.gcj_encrypt(a[1].rectangleData.t_r_LngLat.lat,a[1].rectangleData.t_r_LngLat.lng),a[1].rectangleData[d].b_l_LngLat=GPS.gcj_encrypt(a[1].rectangleData.b_l_LngLat.lat,a[1].rectangleData.b_l_LngLat.lng);a[1].rectangleState.isSetView=!1;TYDrawRectangle(a[1],!0);break;case "polygon":if(c)if(a[1].polygonData.length)for(d=0;d<a[1].polygonData.length;d++)for(b=0;b<a[1].polygonData[d].lnglat.length;b++)a[1].polygonData[d].lnglat[b]=GPS.gcj_decrypt(a[1].polygonData[d].lnglat[b].lat,a[1].polygonData[d].lnglat[b].lng);else for(b=0;b<a[1].polygonData.lnglat.length;b++)a[1].polygonData.lnglat[b]=GPS.gcj_decrypt(a[1].polygonData.lnglat[b].lat,a[1].polygonData.lnglat[b].lng);else if(a[1].polygonData.length)for(d=0;d<a[1].polygonData.length;d++)for(b=0;b<a[1].polygonData[d].lnglat.length;b++)a[1].polygonData[d].lnglat[b]=GPS.gcj_encrypt(a[1].polygonData[d].lnglat[b].lat,a[1].polygonData[d].lnglat[b].lng);else for(b=0;b<a[1].polygonData.lnglat.length;b++)a[1].polygonData.lnglat[b]=GPS.gcj_encrypt(a[1].polygonData.lnglat[b].lat,a[1].polygonData.lnglat[b].lng);a[1].polygonState.isSetView=!1;TYDrawPolygon(a[1],!0);break;case "TYMoveLocus":if(c)for(b=0;b<a[1].locusData.lnglat.length;b++)a[1].locusData.lnglat[b]=GPS.gcj_decrypt(a[1].locusData.lnglat[b].lat,a[1].locusData.lnglat[b].lng);else for(b=0;b<a[1].locusData.lnglat.length;b++)a[1].locusData.lnglat[b]=GPS.gcj_encrypt(a[1].locusData.lnglat[b].lat,a[1].locusData.lnglat[b].lng);a[1].locusState.isSetView=!1;TYMoveLocus(a[1],!0);break;case "TYAreaRender":if(c)for(b=0;b<a[1].renderDatas.length;b++)a[1].renderDatas[b].lnglat=GPS.gcj_decrypt(a[1].renderDatas[b].lnglat.lat,a[1].renderDatas[b].lnglat.lng);else for(b=0;b<a[1].renderDatas.length;b++)a[1].renderDatas[b].lnglat=GPS.gcj_encrypt(a[1].renderDatas[b].lnglat.lat,a[1].renderDatas[b].lnglat.lng);a[1].renderState.isSetView=!1;TYAreaRender(a[1],!0);break;case "circle":if(c)if(a[1].circleData.length)for(d=0;d<a[1].circleData.length;d++)a[1].circleData[d].lnglat=GPS.gcj_decrypt(a[1].circleData[d].lnglat.lat,a[1].circleData[d].lnglat.lng);else a[1].circleData.lnglat=GPS.gcj_decrypt(a[1].circleData.lnglat.lat,a[1].circleData.lnglat.lng);else if(a[1].circleData.length)for(d=0;d<a[1].circleData.length;d++)a[1].circleData[d].lnglat=GPS.gcj_encrypt(a[1].circleData[d].lnglat.lat,a[1].circleData[d].lnglat.lng);else a[1].circleData.lnglat=GPS.gcj_encrypt(a[1].circleData.lnglat.lat,a[1].circleData.lnglat.lng);a[1].circleState.isSetView=!1;TYDrawCircle(a[1],!0)}}var TYMapTiles=function(a){if(!(_ty_driving&&12<=d)){for(var c=_map.getLayers(),b=0;b<c.length;b++)c[b].setMap(null);for(b=0;b<_tytile.length;b++)AMap.event.removeListener(_tytile[b]);_ty_canvas&&(c=_ty_canvas.getContext("2d"),c.clearRect(0,0,c.canvas.width,c.canvas.height));try{var d=null;a&&("object"==typeof a?d=a.TYMapType:"number"==typeof a&&(d=a));3==d&&_map.setLayers([new AMap.TileLayer.RoadNet]);var e=new AMap.TileLayer({zIndex:2,errorUrl:"http://wd.tygps.com:82/tymap/errorUrl.png",getTileUrl:function(a,b,c){var e="";switch(d){case 14:var e=_map.getZoom(),f=new TransformClassNormal(19,3);c=f.pixelToLnglat(0,256,a,b,e);a=f.pixelToLnglat(256,0,a,b,e);return"http://gistest.tygps.com/geoserver/tyall/wms?service\x3dWMS\x26version\x3d1.1.0\x26request\x3dGetMap\x26layers\x3dtyall:TYMap_Demo\x26\x26tiled\x3dtrue\x26styles\x3d\x26bbox\x3d"+[c.lng,c.lat,a.lng,a.lat].join()+"\x26width\x3d256\x26height\x3d256\x26srs\x3dEPSG:4326\x26format\x3dimage/png";case 12:e="http://t1.tianditu.com/DataServer?T\x3dvec_w\x26X\x3d"+a+"\x26Y\x3d"+b+"\x26L\x3d"+c;break;case 13:e="http://t1.tianditu.com/DataServer?T\x3dimg_w\x26X\x3d"+a+"\x26Y\x3d"+b+"\x26L\x3d"+c;break;case 3:a>=Math.pow(2,c)&&(a-=Math.pow(2,c));0>a&&(a=Math.pow(2,c)+a);e="http://webst03.is.autonavi.com/appmaptile?style\x3d6\x26x\x3d"+a+"\x26y\x3d"+b+"\x26z\x3d"+c;break;case 2:a>=Math.pow(2,c)&&(a-=Math.pow(2,c));0>a&&(a=Math.pow(2,c)+a);e="http://webrd01.is.autonavi.com/appmaptile?lang\x3dzh_cn\x26size\x3d1\x26scale\x3d1\x26style\x3d8\x26x\x3d"+a+"\x26y\x3d"+b+"\x26z\x3d"+c;break;case 4:b=Math.pow(2,c)-1-b;e="http://rt0.map.gtimg.com/realtimerender?z\x3d"+c+"\x26x\x3d"+a+"\x26y\x3d"+b+"\x26type\x3dvector\x26style\x3d0\x26v\x3d1.1.2";break;case 5:b=Math.pow(2,c)-1-b;e="http://p1.map.gtimg.com/sateTiles/"+c+"/"+Math.floor(a/16)+"/"+Math.floor(b/16)+"/"+a+"_"+b+".jpg";break;case 6:b=Math.pow(2,c)-1-b;e="http://p3.map.gtimg.com/demTiles/"+c+"/"+Math.floor(a/16)+"/"+Math.floor(b/16)+"/"+a+"_"+b+".jpg";break;case 7:b=Math.pow(2,c)-1-b;e="http://map0.ishowchina.com/sotile/ver8/2/"+c+"?x\x3d"+a+"\x26y\x3d"+b;break;case 8:b=Math.pow(2,c)-1-b;e="http://map0.ishowchina.com/satellite/ver6/2/"+c+"?x\x3d"+a+"\x26y\x3d"+b;break;case 9:e="http://mt3.google.cn/vt/lyrs\x3dm@142\x26hl\x3dzh-CN\x26gl\x3dcn\x26x\x3d"+a+"\x26y\x3d"+b+"\x26z\x3d"+c+"\x26s\x3dGalil";break;case 10:e="http://mt3.google.cn/vt/lyrs\x3dy@142\x26hl\x3dzh-CN\x26gl\x3dcn\x26x\x3d"+a+"\x26y\x3d"+b+"\x26z\x3d"+c+"\x26s\x3dGalil";break;case 11:e="http://mt3.google.cn/vt/lyrs\x3dp@142\x26hl\x3dzh-CN\x26gl\x3dcn\x26x\x3d"+a+"\x26y\x3d"+b+"\x26z\x3d"+c+"\x26s\x3dGalil"}return e}});e.setMap(_map);_ty_view&&14!=d&&_ty_view.setTileLayer(e);var f=new AMap.TileLayer({zIndex:2,errorUrl:"http://wd.tygps.com:82/tymap/errorUrl.png",getTileUrl:function(a,b,c){var e="";switch(d){case 12:e="http://t1.tianditu.com/DataServer?T\x3dcva_w\x26X\x3d"+a+"\x26Y\x3d"+b+"\x26L\x3d"+c;break;case 13:e="http://t1.tianditu.com/DataServer?T\x3dcia_w\x26X\x3d"+a+"\x26Y\x3d"+b+"\x26L\x3d"+c;break;case 3:e=" http://wprd01.is.autonavi.com/appmaptile?x\x3d"+a+"\x26y\x3d"+b+"\x26z\x3d"+c+"\x26lang\x3dzh_cn\x26size\x3d1\x26scl\x3d1\x26style\x3d8\x26ltype\x3d11";break;case 2:break;case 4:b=Math.pow(2,c)-1-b;e="http://rt0.map.gtimg.com/realtimerender?z\x3d"+c+"\x26x\x3d"+a+"\x26y\x3d"+b+"\x26type\x3dvector\x26style\x3d0\x26v\x3d1.1.2";break;case 5:b=Math.pow(2,c)-1-b;e="http://rt0.map.gtimg.com/tile?z\x3d"+c+"\x26x\x3d"+a+"\x26y\x3d"+b+"\x26styleid\x3d2\x26version\x3d110";break;case 6:b=Math.pow(2,c)-1-b;e="http://rt1.map.gtimg.com/tile?z\x3d"+c+"\x26x\x3d"+a+"\x26y\x3d"+b+"\x26type\x3dvector\x26styleid\x3d3\x26version\x3d110";break;case 8:b=Math.pow(2,c)-1-b;e="http://map3.ishowchina.com/sotile/road/ver10/2/"+c+"?x\x3d"+a+"\x26y\x3d"+b;break;default:flag=!1}return e}});7!=d&&9!=d&&10!=d&&11!=d&&2!=d&&f.setMap(_map)}catch(g){console.log(g.message)}if(12<=d&&12>_ty_tileType)for(_map.clearMap(),b=0;b<_ty_overlays.length;b++)_TYRe(_ty_overlays[b],!0);else if(12>d&&12<=_ty_tileType)for(_map.clearMap(),b=0;b<_ty_overlays.length;b++)_TYRe(_ty_overlays[b],!1);_ty_tileType=d;_ty_custom&&1==_ty_custom_flag&&_ty_custom.setMap(_map)}},_tytile=[],_ty_canvas;function TYaddWMS(){_ty_canvas||(_ty_canvas=document.createElement("canvas"));_ty_canvas.id="_ty_canvas";_ty_canvas.width=_map.getSize().width;_ty_canvas.height=_map.getSize().height;_addtytitle();var a=AMap.event.addListener(_map,"dragend",function(){_addtytitle()});_tytile.push(a);a=AMap.event.addListener(_map,"zoomend",function(){_addtytitle()});_tytile.push(a);a=AMap.event.addListener(_map,"moveend",function(){_addtytitle()});_tytile.push(a);a=AMap.event.addListener(_map,"resize",function(){_addtytitle()});_tytile.push(a)}function _addtytitle(){(new AMap.CustomLayer(_ty_canvas,{zooms:[0,18],zIndex:100})).setMap(_map);var a=_ty_canvas.getContext("2d"),c=new Image,b=_map.getBounds(),d=b.getSouthWest().getLng(),e=b.getSouthWest().getLat(),f=b.getNorthEast().getLng(),b=b.getNorthEast().getLat();c.src="http://localhost:2880/service/tymap?x1\x3d"+d+"\x26x2\x3d"+f+"\x26y1\x3d"+e+"\x26y2\x3d"+b+"\x26width\x3d"+_map.getSize().width+"\x26height\x3d"+_map.getSize().height;c.onload=function(){a.drawImage(c,0,0,_map.getSize().width,_map.getSize().height)}}var TYPanorama=function(a){try{var c=a.position;TYShowQQOpenStreetView(c.lng,c.lat,c.lng,c.lat,a.containerId)}catch(b){console.log(b.message)}},_tracffic_tile,_tracffic_t,TYOpenTraffic=function(a,c){addtraffic(a);_tracffic_t=setInterval(function(){addtraffic(a)},c)};function addtraffic(a){_tracffic_tile&&(_tracffic_tile.setMap(null),clearInterval(_tracffic_t));_tracffic_tile=new AMap.TileLayer({zIndex:2,errorUrl:"http://wd.tygps.com:82/tymap/errorUrl.png",getTileUrl:function(c,b,d){1==a&&(b=Math.pow(2,d)-1-b,layurl="https://qhapi.map.ishowchina.com/lkinfo/?act\x3dtile\x26x\x3d"+c+"\x26y\x3d"+b+"\x26z\x3d"+d+"\x26t\x3d1486540983069");2==a&&(b=Math.pow(2,d)-1-b,layurl="http://rtt2.map.qq.com/rtt/?z\x3d"+d+"\x26x\x3d"+c+"\x26y\x3d"+b);3==a&&(layurl="http://tm.amap.com/trafficengine/mapabc/traffictile?v\x3d1.0\x26;t\x3d1\x26\x26x\x3d"+c+"\x26y\x3d"+b+"\x26zoom\x3d"+(17-d));return layurl}});_tracffic_tile.setMap(_map)}var TYCloseTraffic=function(){_tracffic_tile&&(_tracffic_tile.setMap(null),clearInterval(_tracffic_t))};document.write("\x3cscript type\x3d'text/javascript' src\x3d'http://map.qq.com/api/js?v\x3d2.exp\x26key\x3dCBYBZ-BVHHX-LLQ4A-7VFUV-NAJPO-VKFKO'\x3e\x3c/script\x3e");var _streetViewDiv;function TYShowQQOpenStreetView(a,c,b,d,e){var f="yes";"undefined"==typeof e&&(f="no");_streetViewDiv&&(e=_streetViewDiv,document.getElementById(e).style.display="false");"undefined"==typeof e&&(_streetViewDiv=e=TYCeateOpenSteetViewContainer());var g=new qq.maps.LatLng(c,a);document.getElementById(e).innerHTML="";var h=new qq.maps.Panorama(document.getElementById(e));(new qq.maps.PanoramaService).getPano(g,200,function(f){null!=f?(h.setPano(f.svid),f=Math.acos((d-c)/Math.sqrt(Math.pow(b-a,2)+Math.pow(d-c,2))),0>b-a&&(f=2*Math.PI-f),h.setPov({heading:f/Math.PI*180,pitch:0})):document.getElementById(e).innerHTML="\u8be5\u8303\u56f4\u4e0d\u5305\u542b\u5168\u666f"});"no"==f&&TYCeateOpenSteetViewContainerCloseButton(e)}function TYCeateOpenSteetViewContainerCloseButton(a){var c=document.getElementById(a);a=document.createElement("div");a.style.position="absolute";a.style.top="1px";a.style.width="45px";a.style.height="15px";a.style.right="1px";a.style.left="auto";a.style.textAlign="center";a.style.verticalAlign="middle";a.style.zIndex="100000000000";a.style.backgroundColor="#73A2d6";a.id="OpenSteetViewContainer02";a.innerHTML='\x3ca href\x3d"#" style\x3d"font-weight:bold;color:#FFFFFF;font-size:12px"  \x3e[\u5173\u95ed]\x3c/a\x3e';c.appendChild(a);c.onclick=function(){c.style.display="none"}}function TYCeateOpenSteetViewContainer(){var a=document.createElement("div");a.style.position="absolute";a.style.bottom="1px";a.style.width="400px";a.style.height="300px";a.style.right="1px";a.style.left="auto";a.style.zIndex="1100";a.id=TYMapRandomString(10);a.style.display="";document.getElementsByClassName("amap-container")[0].appendChild(a);return a.id}var _position="";function callback(a){_position=eval(a).location}var TYGeolocation=function(a){_map.plugin("AMap.Geolocation",function(){var c=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1E4,showButton:a.showButton,buttonOffset:a.buttonOffset,zoomToAccuracy:a.zoomToAccuracy,showMarker:a.showMarker,showCircle:a.showCircle,buttonPosition:a.buttonPosition,panToLocation:a.panToLocation});_map.addControl(c);c.getCurrentPosition();AMap.event.addListener(c,"complete",function(b){var c={status:!0,position:b.position,accuracy:b.accuracy,info:"ok"};b.isConverted&&(c.position=new TYLngLat_Reverse(b.position.getLng(),b.position.getLat()));null==b.position&&(c.info="\u5b9a\u4f4d\u5931\u8d25");a.callback&&a.callback(c)});AMap.event.addListener(c,"error",function(b){b={status:!1,position:null,accuracy:null,info:"\u5b9a\u4f4d\u5931\u8d25"};a.callback&&""!=a.callback&&a.callback(b)})})},TYSearch=function(a){a?AMap.service(["AMap.PlaceSearch"],function(){var c,b,d,e,f;a.city&&(b=a.city);a.pageType&&(c=a.pageType);a.inCity&&(e=a.inCity);a.panelId&&(d=a.panelId);a.search?f=a.search:console.log("\u67e5\u8be2\u5173\u952e\u5b57\u7f3a\u5931\uff01");a.func&&(func=a.func);(new AMap.PlaceSearch(b?{citylimit:e,pageSize:c[0],pageIndex:c[1],extensions:"all",map:_map,city:b,panel:d}:{citylimit:e,pageSize:c[0],pageIndex:c[1],map:_map,extensions:"all",panel:d})).search(f,function(a,b){if("complete"==a&&("OK"==b.info||"TIP_KEYWORDS"==b.info)){var c=[],d={};if(b.poiList){d.status=!0;b.poiList.count&&(d.count=b.poiList.count);b.poiList.pageIndex&&(d.pageIndex=b.poiList.pageIndex);b.poiList.pageSize&&(d.pageSize=b.poiList.pageSize);if(b.poiList.pois){var e=b.poiList.pois,f;for(f in e){var g;if(e[f].location)try{var h=e[f].location;g=GPS.gcj_decrypt_exact(h.lat,h.lng);g=[g.lng,g.lat]}catch(q){g=null}else g=null;c.push({id:e[f].id,name:e[f].name,type:e[f].type,location:g,address:e[f].address,distance:e[f].distance,tel:e[f].tel,website:e[f].website,pcode:e[f].pcode,citycode:e[f].citycode,adcode:e[f].adcode,postcode:e[f].postcode,pname:e[f].pname,cityname:e[f].cityname,adname:e[f].adname,email:e[f].email})}}d.searchList=c}else 0==d.status;func&&func(d)}})}):console.log("\u67e5\u8be2\u670d\u52a1\u5fc5\u987b\u5165\u53c2")},_ty_wms_array=[],TYWMSTiles=function(a){if(void 0!=a.url&&""!=a.url.trim()){var c;if(a.IsTile){var b=a.url;0>b.indexOf("?")&&(b+="?");0>b.indexOf("http://")&&(b="http://"+b);""!=a.layers&&(b=b+"layers\x3d"+a.layers);""!=a.version&&(b=b+"\x26version\x3d"+a.version);""!=a.srs&&(b=b+"\x26srs\x3d"+a.srs);""!=a.format&&(b=b+"\x26format\x3d"+a.format);""!=a.styles&&(b=b+"\x26styles\x3d"+a.styles);""!=a.transparent&&(b=b+"\x26transparent\x3d"+a.transparent);c=new AMap.TileLayer({zIndex:5555,errorUrl:"http://wd.tygps.com:82/tymap/errorUrl.png",getTileUrl:function(a,c,d){var e=_map.getZoom(),f=new TransformClassNormal(19,3);d=f.pixelToLnglat(0,256,a,c,e);a=f.pixelToLnglat(256,0,a,c,e);c=GPS.gcj_decrypt(d.lat,d.lng);e=GPS.gcj_decrypt(a.lat,a.lng);return b+"\x26service\x3dWMS\x26request\x3dGetMap\x26tiled\x3dtrue\x26bbox\x3d"+(12<=_ty_tileType?[d.lng,d.lat,a.lng,a.lat]:[c.lng,c.lat,e.lng,e.lat]).join(",")+"\x26width\x3d256\x26height\x3d256"}})}else{var d=a.url;0>d.indexOf("?")&&(d+="?");0>d.indexOf("http://")&&(d="http://"+d);""!=a.layers&&(d=d+"layers\x3d"+a.layers);""!=a.version&&(d=d+"\x26version\x3d"+a.version);""!=a.srs&&(d=d+"\x26srs\x3d"+a.srs);""!=a.format&&(d=d+"\x26format\x3d"+a.format);""!=a.styles&&(d=d+"\x26styles\x3d"+a.styles);""!=a.transparent&&(d=d+"\x26transparent\x3d"+a.transparent);var e=document.createElement("canvas");e.width=_map.getSize().width;e.height=_map.getSize().height;c=new AMap.CustomLayer(e,{zooms:[3,18],zIndex:5555});c.render=function(a){var b=e.getContext("2d");b.clearRect(0,0,_map.getSize().width,_map.getSize().height);var c=new Image;a=GPS.gcj_decrypt(_map.getBounds().getSouthWest().getLat(),_map.getBounds().getSouthWest().getLng());var f=GPS.gcj_decrypt(_map.getBounds().getNorthEast().getLat(),_map.getBounds().getNorthEast().getLng());a=d+"\x26service\x3dWMS\x26request\x3dGetMap\x26tiled\x3dtrue\x26bbox\x3d"+[a.lng,a.lat,f.lng,f.lat].join()+"\x26width\x3d"+_map.getSize().getWidth()+"\x26height\x3d"+_map.getSize().getHeight();c.src=a;c.onload=function(){b.drawImage(c,0,0,_map.getSize().width,_map.getSize().height)}}}c.setMap(_map);c.Id="";""!=a.Id&&(c.Id=a.Id);_ty_wms_array.push(c);return c}},TYRemoveWMSTiles=function(a){if(a)for(var c=0;c<_ty_wms_array.length;c++)_ty_wms_array[c].Id&&_ty_wms_array[c].Id==a&&_ty_wms_array[c].setMap(null);else for(c=0;c<_ty_wms_array.length;c++)_ty_wms_array[c].setMap(null)};function TYPixel(a,c){return new AMap.Pixel(a,c)}function TYSize(a,c){return new AMap.Size(a,c)}function TYLngLat_Normal(a,c){return new AMap.LngLat(a,c)}function GPSLngLat(a){a=12>_ty_tileType?new TYLngLat_Reverse(a.lng,a.lat):a;return{GPSLng:a.getLng(),GPSLat:a.getLat()}}function TYLngLat(a,c){return 12>_ty_tileType?GPS.gcj_encrypt(c,a):new AMap.LngLat(a,c)}function TYLngLat_Reverse(a,c){return GPS.gcj_decrypt(c,a)}function TYLabel(a){this.content;this.offset;a&&(a.content&&(this.content=a.content),a.offset&&(this.offset=a.offset))}function TYIcon(a){if(a&&"string"==typeof a)return a;this.url="http://webapi.amap.com/theme/v1.3/markers/n/mark_b.png";this.offset=new TYPixel(0,0);return a?(a.url&&(this.url=a.url),a.offset&&(this.offset=a.offset),a.size?new AMap.Icon({image:this.url,size:a.size,imageOffset:this.offset}):new AMap.Icon({image:this.url,imageOffset:this.offset})):new AMap.Icon({image:this.url,imageOffset:this.offset})}function TYOverlayEvent(a){this.mouseEvent=TYEnumEvent.TY_CLICK;a&&(a.mouseEvent&&(this.mouseEvent=a.mouseEvent),a.mouseFunc&&(this.mouseFunc=a.mouseFunc))}function TYCar(a,c){var b=document.createElement("div");b.id="mymovecar";b.style.position="absolute";var d=document.createElement("img");d.src="http://webapi.amap.com/images/car.png";c.icon&&(d.src=c.icon);b.appendChild(d);b=new AMap.Marker({position:a,offset:new AMap.Pixel(-26,-13),content:b});b.setRotation=function(a){!isNaN(a)&&360>=a&&0<=a&&(document.getElementById("mymovecar").style.transform="rotate("+a+"deg)")};return b}var TYMapLib=window.TYMapLib=TYMapLib||{},_Info_Window,StreetViewFlowContainer="";(function(){var a=TYMapLib.TYTrack=function(a,b,d){!b||1>b.length||(this.ismove=!1,this._cc=0,this._map=a,this._path=b,this.i=0,this._setTimeoutQuene=[],this._opts={icon:"http://webapi.amap.com/images/car.png",speed:400,defaultContent:""},this._setOptions(d),this._rotation=0,d.icon&&(this._opts.icon=d.icon),d.speed&&(this._opts.speed=d.speed))};a.prototype._setOptions=function(a){if(a)for(var b in a)a.hasOwnProperty(b)&&(this._opts[b]=a[b])};a.prototype.start=function(){this.ismove=!0;var a=this,b=a._path.length;if(a.i&&a.i<b-1)if(a._fromPause)a._fromStop||a._moveNext(++a.i);else return;else a._addMarker(),a._timeoutFlag=setTimeout(function(){a._moveNext(a.i)},400);this._fromStop=this._fromPause=!1};a.prototype.stop=function(){this.ismove=!1;this.i=0;this._fromStop=!0;clearInterval(this._intervalFlag);this._clearTimeout()};a.prototype.pause=function(){clearInterval(this._intervalFlag);this._fromPause=!0;this._clearTimeout()};a.prototype.setIndex=function(a){this.i=a;clearInterval(this._intervalFlag);this._fromSetIndex=!0;this._clearTimeout();this._addMarker();this._fromPause=!0};a.prototype.hideInfoWindow=function(){this._overlay._div.style.visibility="hidden"};a.prototype.showInfoWindow=function(){this._overlay._div.style.visibility="visible"};a.prototype._addMarker=function(a){this._marker&&(this._fromSetIndex?this._fromPause?this.pause():(this._fromPause=!0,this.start()):this.stop(),this._marker.setMap(null),clearTimeout(this._timeoutFlag));this._overlay&&this._overlay.setMap(null);a=new TYCar(this._path[this.i],this._opts);a.setMap(_map);this._opts.defaultContent&&""!=this._opts.defaultContent&&a.setLabel(this._opts.defaultContent);this._marker=a};a.prototype._addInfoWin=function(){var a=new CustomOverlay(this._marker.getLngLat(),this._opts.defaultContent);a.setRelatedClass(this);this._overlay=a;this._map.TYaddOverLay(a)};a.prototype._getDistance=function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))};a.prototype._move=function(a,b,d,e){var c=this;c.ismove=!0;e||(e=0);var g=this._opts.speed/100,h=this._map.lngLatToContainer(a,_map.getZoom()),k=this._map.lngLatToContainer(b,_map.getZoom()),l=Math.round(c._getDistance(h,k)/g);1>l?c._moveNext(++c.i):c._intervalFlag=setInterval(function(){if(e>=l)clearInterval(c._intervalFlag),c.i>c._path.length||c._moveNext(++c.i);else{e++;c._cc=e;var f=d(h.x,k.x,e,l),g=d(h.y,k.y,e,l),f=c._map.containerToLngLat(new AMap.Pixel(f,g));1==e&&(g=null,0<=c.i-1&&(g=c._path[c.i-1]),1==c._opts.enableRotation&&c.setRotation(g,a,b),c._opts.autoView&&(c._map.getBounds().contains(f)||c._map.panTo(f)));c._marker.setPosition(f)}},10)};a.prototype.setRotation=function(a,b,d){b=this._map.lngLatToContainer(b);d=this._map.lngLatToContainer(d);a=Math.abs(d.x-b.x);var c=Math.abs(d.y-b.y);a=Math.round(Math.asin(c/Math.sqrt(a*a+c*c))/Math.PI*180);c=0;d.y<b.y&&d.x==b.x?c=270:d.y>b.y&&d.x==b.x?c=90:d.y==b.y&&d.x<b.x?c=180:d.y==b.y&&d.x>b.x?c=0:d.y>b.y&&d.x>b.x?c=a:d.y>b.y&&d.x<b.x?c=180-a:d.y<b.y&&d.x<b.x?c=180+a:d.y<b.y&&d.x>b.x&&(c=360-a);this._marker.setRotation(c)};a.prototype.linePixellength=function(a,b){return Math.sqrt(Math.abs(a.x-b.x)*Math.abs(a.x-b.x)+Math.abs(a.y-b.y)*Math.abs(a.y-b.y))};a.prototype.pointToPoint=function(a,b){return Math.abs(a.x-b.x)*Math.abs(a.x-b.x)+Math.abs(a.y-b.y)*Math.abs(a.y-b.y)};a.prototype._moveNext=function(a){this.ismove=!0;this._opts.func&&""!=this._opts.func&&eval(this._opts.func.syncEvent)(a);a==this._path.length-1&&this._opts.circlable&&(this.i=a=0);if(a==this._path.length-1&&0==this._opts.circlable){var b=this._opts.speed/100,d=this._path[a-1],c=this._path[a],f=this._tween.linear;init_pos=this._map.lngLatToContainer(d,_map.getZoom());target_pos=this._map.lngLatToContainer(c,_map.getZoom());b=Math.round(this._getDistance(init_pos,target_pos)/b);f(init_pos.x,target_pos.x,0,b);f(init_pos.y,target_pos.y,0,b);f=this._map.containerToLngLat(new AMap.Pixel(target_pos.x,target_pos.y));b=this._path[this.i-2];1==this._opts.enableRotation&&this.setRotation(b,d,c);this._marker.setPosition(f);this.stop()}a<this._path.length-1&&this._move(this._path[a],this._path[a+1],this._tween.linear)};a.prototype._setInfoWin=function(a){if(this._overlay){this._overlay.setPosition(a,this._marker.getIcon().size);var b=this._troughPointIndex(a);-1!=b?(clearInterval(this._intervalFlag),this._overlay.setPosition(a,this._marker.getIcon().getSize()),this._pauseForView(b)):this._overlay.setHtml(this._opts.defaultContent)}};a.prototype._pauseForView=function(a){var b=this;a=setTimeout(function(){b._moveNext(++b.i)},1E3*b._opts.landmarkPois[a].pauseTime);b._setTimeoutQuene.push(a)};a.prototype._clearTimeout=function(){for(var a in this._setTimeoutQuene)clearTimeout(this._setTimeoutQuene[a]);this._setTimeoutQuene.length=0};a.prototype._tween={linear:function(a,b,d,e){return(b-a)*d/e+a}};a.prototype._troughPointIndex=function(a){for(var b=this._opts.landmarkPois,d,c=0,f=b.length;c<f;c++)if(!b[c].bShow&&(d=a.distance(new AMap.LngLat(b[c].lng,b[c].lat)),10>d))return b[c].bShow=!0,c;return-1}})();var _started,ty_massdata,_ty_canvas_mass,_ty_massdata_order;function onRender(){_started?DrawMarkerCollection(_map,_ty_massdata_order):(TYMassPoint_1(ty_massdata),_started=!0)}function getSortFun(a,c){return new Function("a","b","return a."+c+("asc"==a?"\x3e":"\x3c")+"b."+c+"?1:-1")}var TYMassClear=function(){_ty_custom_flag=!1;for(var a=0;a<_ty_mass_events.length;a++)AMap.event.removeListener(_ty_mass_events[a]);context=_ty_canvas_mass.getContext("2d");context.fillStyle="#FF0000";context.linewidth=0;context.clearRect(0,0,context.canvas.width,context.canvas.height);_ty_massdata_order=null;_ty_custom.setMap(null)},_ty_mass_events=[],_ty_custom,_ty_custom_flag=!1,TYMassPoint=function(a){_ty_custom_flag=_ty_driving=!0;a.massPointState.isClearOverlay&&_ty_canvas_mass&&(TYMassClear(),_started=!1);ty_massdata=a;_ty_canvas_mass?TYMassPoint_1(a):(_ty_canvas_mass=document.createElement("canvas"),_ty_canvas_mass.width=_map.getSize().width,_ty_canvas_mass.height=_map.getSize().height,_ty_custom=new AMap.CustomLayer(_ty_canvas_mass,{zooms:[0,18],zIndex:9999}),_ty_custom.render=onRender);_ty_custom.setMap(_map)},TY_Index=function(a,c){var b=0,d=a.length-1,e,f=0;if(b==d)return 0;for(;b<=d;)if(e=Math.floor((b+d)/2),a[e].lng<c){if(b=e+1,b>d){f=e;break}}else if(a[e].lng>c){if(d=e-1,b>d){f=e;break}}else{f=e;break}f>=a.length&&(f=a.length-1);return f},TYMassPoint_1=function(a){for(var c=_map,b=a.massPointDatas,d=[],e=0;e<b.length;e++){var f=new TYLngLat(b[e].lng,b[e].lat),g={};g.id=b[e].id;g.url=b[e].url;g.color=b[e].color;g.opacity=b[e].opacity;g.size=b[e].size;g.type=b[e].type;g.lng=f.getLng();g.lat=f.getLat();d.push(g)}d.sort(getSortFun("asc","lat"));b=d[d.length-1].lat;e=d[0].lat;d.sort(getSortFun("asc","lng"));_ty_massdata_order=d;e=new AMap.LngLat(d[0].lng,e);b=new AMap.LngLat(d[d.length-1].lng,b);a.massPointState.isSetView&&_map.setBounds(new AMap.Bounds(e,b));DrawMarkerCollection(c,d);b=AMap.event.addListener(c,"mousemove",function(a){-1!=_doEvent(a,d)?_map.setDefaultCursor("pointer"):_map.setDefaultCursor("url('http://webapi.amap.com/theme/v1.3/openhand.cur'),pointer")});_ty_mass_events.push(b);a.massPointState.overlayEvent&&""!=a.massPointState.overlayEvent&&(c=AMap.event.addListener(c,a.massPointState.overlayEvent.mouseEvent,function(b){var c=_doEvent(b,d);-1!=c&&(b={},b.id=d[c].id,b.url=d[c].url,b.color=d[c].color,b.opacity=d[c].opacity,b.size=d[c].size,b.type=d[c].type,c=new TYLngLat_Reverse(d[c].lng,d[c].lat),b.GPSlng=c.getLng(),b.GPSlat=c.getLat(),a.massPointState.overlayEvent.mouseFunc(b))}),_ty_mass_events.push(c));return this};function _doEvent(a,c){var b=_map,d=b.getBounds(),e=d.southwest.lng,f=d.northeast.lat,d=b.getZoom(),e=new AMap.LngLat(e,f),f=b.lnglatToPixel(a.lnglat,d).x-b.lnglatToPixel(e,d).x,g=b.lnglatToPixel(a.lnglat,d).y-b.lnglatToPixel(e,d).y,h=a.lnglat.lng+1,k=TY_Index(c,a.lnglat.lng-1),h=TY_Index(c,h);h==c.length&&(h=c.length-1);0>k&&(k=0);for(var l=_ty_canvas_mass.getContext("2d");k<=h;k++){point=new AMap.LngLat(c[k].lng,c[k].lat);var m=b.lnglatToPixel(point,d).x-b.lnglatToPixel(e,d).x,n=b.lnglatToPixel(point,d).y-b.lnglatToPixel(e,d).y;l.beginPath();l.rect(m,n,15,15);if(l.isPointInPath(f,g))return k;l.closePath()}return-1}function DrawMarkerCollection(a,c){var b;b=_ty_canvas_mass.getContext("2d");b.fillStyle="#FF0000";b.linewidth=0;b.clearRect(0,0,b.canvas.width,b.canvas.height);var d=a.getBounds(),e=d.southwest.lng,f=d.northeast.lat,g=TY_Index(c,e),d=TY_Index(c,d.northeast.lng);d==c.length&&(d=c.length-1);0>g&&(g=0);new AMap.LngLat(e,f);if(document.createElement("canvas").getContext)for(e=g;e<=d;e++)_TY_MarkerShape(a,b,c[e])}function brgba(a,c){if(-1==a.indexOf("#"))return a;var b="#"==a.charAt(0)?a.substring(1):a,d=parseInt(b.substring(0,2),16),e=parseInt(b.substring(2,4),16),b=parseInt(b.substring(4,6),16);return"rgba("+d+","+e+","+b+","+c+")"}function _TY_MarkerShape(a,c,b){a.getZoom();var d=new AMap.LngLat(b.lng,b.lat);a=a.lngLatToContainer(d);var e=a.x,f=a.y;a=b.type;var g=b.size+1;c.fillStyle=brgba(b.color,b.opacity);switch(a){case 5:c.beginPath();c.moveTo(e-2.5*g,f-2.5*g);c.fillRect(e,f,5*g,5*g);break;case 2:c.beginPath();c.moveTo(e-1.5*g,f-1.5*g);e+=3*g;f+=3*g;c.arc(e,f,3*g,0,2*Math.PI,!0);c.fill();break;case 3:c.beginPath();e+=3*g;a=6*g*Math.sin(Math.PI/10);var d=6*g*Math.cos(Math.PI/10),h=3*g*Math.tan(Math.PI/5);c.lineTo(e+a,f+d);c.lineTo(e-3*g,f+h);c.lineTo(e+3*g,f+h);c.lineTo(e-a,f+d);c.lineTo(e-a,f+d);c.lineTo(e,f);c.closePath();c.fill();break;case 4:c.beginPath();c.moveTo(e-g,0);e+=2*g;f+=2*g;c.arc(e,f,3*g,0,2*Math.PI,!0);c.fill();c.moveTo(e-3*g,f);c.lineTo(e+3*g,f);c.lineTo(e,f+6*g);c.lineTo(e-3*g,f);c.closePath();c.fill();break;case 1:c.moveTo(e-5*g,f-5*g);var k=new Image;k.src=b.url;k.onload=function(){c.globalAlpha=b.opacity;c.drawImage(k,e,f,5*g,5*g)}}}Ajax=function(){return{request:function(a,c){function b(){}var d=!1!==c.async,e=c.method||"GET",f=c.data||null,g=c.success||b,h=c.failure||b,e=e.toUpperCase();"GET"==e&&f&&(a+=(-1==a.indexOf("?")?"?":"\x26")+f,f=null);var k=null;if(window.ActiveXObject)for(var l="Msxml2.XMLHTTP.6.0 Msxml2.XMLHTTP.5.0 Msxml2.XMLHTTP.4.0 Msxml2.XMLHTTP.3.0 Msxml2.XMLHTTP Microsoft.XMLHTTP".split(" "),m=0;m<l.length;m++)try{k=new ActiveXObject(l[m]);break}catch(n){}else if(window.XMLHttpRequest)try{k=new XMLHttpRequest}catch(n){k=null}else k=null;k.open(e,a,d);"POST"==e&&k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.onreadystatechange=function(){var a=k;if(4==a.readyState){var b=a.status;200<=b&&300>b?g(a):h(a)}};k.send(f);return k}}}();function _Math_sinh(a){return(Math.exp(a)-Math.exp(-a))/2}var TransformClassNormal=function(a,c){this.levelMax=a;this.levelMin=c;this._getMapSize=function(a){return Math.pow(2,a)};this.getResolution=function(a,c){return 12756274*Math.PI*Math.cos(a)/256/this._getMapSize(c)};this._lngToTileX=function(a,c){return Math.floor((a+180)/360*this._getMapSize(c))};this._latToTileY=function(a,c){var b=a*Math.PI/180;return Math.floor((1-Math.log(Math.tan(b)+1/Math.cos(b))/Math.PI)/2*this._getMapSize(c))};this.lnglatToTile=function(a,c,e){var b={};b.tileX=this._lngToTileX(a,e);b.tileY=this._latToTileY(c,e);return b};this._lngToPixelX=function(a,c){return Math.round((a+180)/360*this._getMapSize(c)*256%256)};this._latToPixelY=function(a,c){var b=Math.sin(a*Math.PI/180);return Math.round((.5-Math.log((1+b)/(1-b))/(4*Math.PI))*this._getMapSize(c)*256%256)};this.lnglatToPixel=function(a,c,e){var b={};b.pixelX=this._lngToPixelX(a,e);b.pixelY=this._latToPixelY(c,e);return b};this._pixelXTolng=function(a,c,e){return(c+a/256)/this._getMapSize(e)*360-180};this._pixelYToLat=function(a,c,e){return 180*Math.atan(_Math_sinh(Math.PI*(1-2*(c+a/256)/this._getMapSize(e))))/Math.PI};this.pixelToLnglat=function(a,c,e,f,g){var b={};b.lng=this._pixelXTolng(a,e,g);b.lat=this._pixelYToLat(c,f,g);return b}};